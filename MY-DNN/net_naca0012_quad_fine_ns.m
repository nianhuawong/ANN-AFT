function [Y,Xf,Af] = net_naca0012_quad_fine_ns(X,~,~)
%NET_NACA0012_QUAD_FINE_NS neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-Aug-2020 17:18:08.
% 
% [Y] = net_naca0012_quad_fine_ns(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 4xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-10;-10;-10;-10;-10;-10;-10;-10];
x1_step1.gain = [0.1;0.1;0.1;0.1;0.1;0.1;0.1;0.1];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.9837361944914571055;-1.7037849664186881515;3.0238864517805459364;-0.99700385366006871735;-0.031610219864761021635;0.79756437192910800693;-0.072895968489861809325;0.16311776995315027672;0.9376270101493897613;0.85507112879522095827;-1.321767030631747275;-0.018162708933085386365;-1.6034570625217405837;-1.1272405309157402797;0.12753312293741297934];
IW1_1 = [0.067331298790933691301 -1.4019168781833946102 0.28637733100525269991 -0.15713619820328150745 0.017630019548149883368 -1.2004506764434732524 1.467893021764946182 0.072654971900951215158;-0.95580441723594766756 -0.5772160796855481113 -0.4824291502662629294 1.8130547230396250047 -0.2607909216735055935 -0.86098319646345677914 -1.3601954157231492815 -0.047662290080580593798;-0.47067846863591378259 0.53032870075772786667 1.5758722097370685411 0.5726784741883023111 0.050631137451034410879 0.18194508714209034483 -0.74648540843844635173 0.055833450347170722472;-0.15687977832973848402 -1.5794579105707184929 3.2266183871836577879 0.71871672695473709513 -1.1779033232486515459 2.305371558791064146 -2.1185824439617824133 -1.2031563160274425517;0.020245080257310192617 -0.57254516309421932263 0.67647350661429750396 -0.075097732217986726266 0.039090581388561508602 0.15837751832450580602 0.46038403395358695747 0.013362710127204094346;1.2565657157753002959 1.5254511737099152313 0.46635167095038176921 0.052669773491116310404 -0.96771141304033836406 0.54320989308147094032 0.44805712028345173747 0.32950607114323310354;0.056580088899588910911 1.060308794783482611 -0.88002642282164311727 -0.20724900479297053701 -0.0060996242021554274854 -2.7175131034217265835 2.2879317181953093829 0.00429339924977728115;-0.33016199104635429729 -1.726869494423785456 1.8185843177710998564 0.48570982585443045476 -0.00046557370087423023079 -0.23808352611595542947 0.28687124507116662508 -0.057918178727581051679;0.13287899579337489331 1.7886070234028346171 -3.2452071576061949365 -0.90574678810229181103 1.2623253131633154211 0.41071329542501422427 -0.58739881005407412751 1.3071301579536451776;-0.034872066429739473348 0.14939755484825323339 -0.71011540037285736382 0.055047587123164855305 -0.027230748384293481518 -0.41740433478088945218 0.32495801790907136164 -0.020008048187967884812;-0.0891216182765038889 -1.6470525139728935393 0.55635819928920160482 0.041229736673306892347 0.058909609280045766022 2.41475176651795298 -2.6636645282533830681 0.020180859652498817775;0.019610240355444029381 -0.14047442350053118698 0.17343252058709390795 -0.035101636664189077297 0.0088454311478410145575 0.2446249228980224566 0.0667417983107183449 0.0053864941991957730749;-0.56771600439608982391 -2.2952155493140034004 0.13139486536014635676 0.63352806195964905811 0.06874584540147297973 -0.20237575062303836404 0.044750405855002929612 -0.13668488076401716369;-0.16584549440598048142 -0.74605520051872908915 -0.28444324311371838032 0.20136474593407630018 0.0066301136116449837718 -0.83874885781575769794 0.72601474066269378049 -0.032911948719954321751;-0.16418920687263982572 -1.9314209034223395189 1.8104024535891027892 0.26015749618423622547 0.023799547262902835676 -0.48267686922320940379 0.1238178063074637375 -0.01072481892405133079];

% Layer 2
b2 = [0.25099495501815671794;0.37986185303889558051;-1.4343020746219385941;-0.041786930254860674139;0.69702048833050644916;0.35867366887777996087;-1.9041429852758533503;2.0028889509430647387];
LW2_1 = [-0.51647424011248066478 0.54681119242343745324 1.1325910947893478298 0.14394094109487332034 0.74834587557464671281 -0.47344554684922479648 -2.3751916149320804195 0.53166207995219894045 0.52515468654107444468 -1.1613851458546642359 1.7314756402827025106 0.36021297897249071607 0.1790801426441001043 -2.7675412497422522407 -0.57035626371911074539;-0.26975021106648316982 -0.0085280154374299099035 0.036660770037655672493 -0.052175966367072758312 0.18755417175487670844 -0.010380932155093619204 -0.26648344194908912819 0.20250004148588712782 -0.064596108839913637945 -0.82222955981719025864 0.057142948339730270657 -1.5091594543718482857 0.074975025836299238891 -0.80165885387506319315 -0.36899479013123598348;0.54333334776891628604 -0.090188790463150883547 -2.1672390108530676933 -0.8255126935045297154 -0.85758425735073351426 0.32729911405078465636 1.6494371754436172317 1.0497439119866278645 0.3669305865076060158 1.292812740616793743 -0.90515660311424050999 1.3412331777382018316 0.10284874249311844185 1.6310548572887173524 2.026588144744955855;-0.00095384853392966803542 -0.0049973832038642286568 -0.0072416224316391346674 0.014170233414134763769 0.62646355127086683634 -0.00083122969430990292609 -0.23227178601392492463 -0.1427256621971593753 0.016010259752844317044 -0.048669562442806839353 0.019204370338945835062 -2.8262055298519199731 0.03411192124133421294 -0.11802735339489967004 -0.084516010343458902732;0.32437518833301354215 0.01117098311836779885 -0.41517437851695887518 -0.52136030565848168195 0.67572846646702833251 -0.031003764420817279956 0.5170986910909336487 0.15853839933188534905 -0.53685658113244272283 1.6600219825809328089 0.75116753092811072712 0.47051136048039782223 -0.69041136470856245833 1.3208699720219243545 0.5189756629141132338;0.00062294852684912694653 0.013044864127782227273 0.0086593418190159671122 0.067806573550885859691 -0.067592201292714440553 0.0016230021687483481025 -0.49426001970332428259 -0.3792870971468709218 0.075367763206683160981 0.37794665220928908012 0.12626560653239990439 -0.37361292130110174137 -0.034722093332579112568 0.41475427330615377564 0.15748718918382120791;0.48465167330392661116 0.0037046893277199841217 0.039734443867507338033 -0.30886438479108047073 0.64503662923945270791 0.055446940538232444839 0.36201407215480563284 -0.22562529538598391499 -0.32414074416887839192 0.23683534923342500211 1.3006477239292766335 0.96185365540473144463 -0.14049913329770455372 -1.7835440057736695607 1.8024377401866000792;-0.82806886483384545272 0.1021023159600429886 0.66723172453656953707 0.35268428322973116584 -1.4743956778363098703 -0.097370785873087006834 -1.8850817464235609666 -1.0667775547802329505 0.37856247648510205073 -0.0077091913326867884948 -0.86356559605158256243 -0.61644943211185554421 0.679029846458128028 1.9251854540931430115 -0.94403648116049276862];

% Layer 3
b3 = [-0.028523852214117920156;0.45723178146517184928;-0.15554181028416935728;0.00045203311793457954214];
LW3_2 = [0.015171001718278741971 1.3474679460818641541 0.038436599546725978838 -0.062095915520226439843 -0.22317093292657272374 -0.42133518354672661044 -0.18279572632338181304 -0.064585291307765815838;0.016653747538576565285 0.97302525779224680047 0.040052886459871421543 -0.0018980308360208785964 -0.42136999097854976881 -0.66790040847298604021 0.32863921747157132103 0.038510466480002246425;0.014881849248324845875 0.2860964663595061408 -0.015333907018082813811 -2.8445693863364711618 -0.11841902299326292902 0.93675579353199556198 0.11889028377173326001 -0.049900726958332843053;0.019138691670876523815 -0.062168448435333652224 -0.022377531628409889214 -2.7097277202937100071 -0.11836121606404043094 0.42154116021730586583 0.13388396255169759952 -0.033889824299230070226];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [0.1;0.1;0.1;0.1];
y1_step1.xoffset = [-10;-10;-10;-10];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
