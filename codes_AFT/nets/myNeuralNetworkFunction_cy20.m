function [Y,Xf,Af] = myNeuralNetworkFunction_cy20(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 05-Jul-2020 16:31:48.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx8 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx2 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [-10;-10;-10;-10;-10;-10;-10;-10];
x1_step1_gain = [0.1;0.1;0.1;0.1;0.1;0.1;0.1;0.1];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.991171293896244;-0.724907823304481;2.2493511086299565;-1.6077863837037547;-3.0682865517846492;-2.4262667933096695;3.0493654330167246;2.0293257646159892;0.95882306483706803;5.5465897522807532;2.9697938891595586;-0.055949183812664387;0.042432941730643013;-2.227405450000171;-0.91555929449080231;0.12054743891104786;0.0034105549284708671;0.60139183673399699;-0.84489707638597922;-2.0988554347626223;-3.0504581875233518;-0.016014084621157863;0.11989044147430528;0.0031162790329674768;0.012430512950280971;1.6449937739138747;-0.40036892489367448;1.5323549941808485;1.9750117013815212;-2.7564798727575615;-1.0716573986370954;2.7109727148268936;1.9371554578773571;1.1483529961848691;-2.457127755551427;7.7692184443839949;-2.0937791105518979;-1.8025082111618731;3.7793680534908765;0.23821296258506339];
IW1_1 = [0.14342647271877343 -8.1119486189305849 6.1266835700185478 0.079333967393805313 -0.064162509384753763 3.5180783132320741 -1.8995810077861774 0.25538788547971086;-0.08411877545972106 3.793127036542884 -2.6852576963343098 -0.020507729089835981 0.072401258305338417 -1.380435405245594 0.34918768716924581 -0.048454744827401315;-0.20412964317633972 -2.6579670678070499 2.8228560960472033 0.04236331875527416 0.21861529932377369 -3.3407134721218794 6.5100971550984807 0.03262216823150299;-0.18767574041378304 -2.20999209640159 -2.7077957323572961 -0.38033583194458676 0.68159969661575592 10.116928651904463 -8.2836969080526028 0.10163093148670442;-0.35888626004095292 6.5885085047226504 -2.7053675889814865 -0.16890991553199089 0.013863315570250031 4.3368995542625921 -4.585627580422341 0.16658308660420729;0.14038025627028353 -9.4754571397745693 14.685242799948336 0.68243751132885588 0.049138490603811077 -7.4856362856063656 11.649144042482533 -0.66698976873522631;-0.27036102515499832 6.7022074490891317 -2.9575889528439823 -0.2947112761967845 0.0082544825176404327 6.221689776788871 -6.2251946570880285 -0.15574626897051705;-0.17147264647124269 -1.7057117429446711 1.5796662126012104 0.045243819843722763 0.10990270113365727 -2.6780509842693569 5.3245130103470641 0.093814928626852451;0.026760790201996162 -0.82784083028114719 1.711471290420524 0.018753566032792393 0.012934770871724396 0.97941549173312914 -0.93527659132719931 0.0093217240603897748;0.11289616525405592 7.4041767484967647 -7.9350642554920929 -0.68235549306049814 0.11930120848899251 4.8577072266886709 -10.655024585610297 -0.52747300091014915;0.20949391852629903 -2.478199969695785 2.4853219391709471 -0.46930410029167346 0.98728515276131823 -3.7475865561871187 2.5000866724634876 -0.54865762734884482;-0.19244754097018749 2.3157096687885796 -2.0358863722276839 -0.058702335838174656 0.1531168349163006 -6.7696692798407341 6.7962612490036713 -0.040785346478206468;-0.10806665452129707 0.018041430085213014 0.24174356216961665 -0.076767027971337096 0.065368859669687626 0.066132774952896836 -0.11746126152007427 0.048133191275700919;-0.5390236354089184 14.413345595966868 -6.275260056931212 -0.98500232563424484 -0.29538820754437367 5.9856895164591997 -5.5041901408235967 0.29738590047993035;0.069158503658612855 -2.2475089787344458 3.7625529826905866 0.055731002607425459 0.023478807249776249 1.0785311554392776 -1.0113381024037515 0.0075835229112525158;0.42511910509350209 0.61030475260394546 -6.0396420343081507 -0.32972332884949762 -0.03933735525361827 -12.043051568525549 16.497035039005823 0.54634836072241044;-0.37239596827612309 2.6302465133002091 -5.4607743282635832 3.1975702984568439 0.2385923567379262 -1.0798542873780792 2.5095027246420947 -1.6634489583931409;-0.12858444769187388 4.7518153656775919 -7.9423048615665586 0.29221997468949507 -0.057139281541016711 -6.361185540753949 6.9922636961511317 0.21521191660072775;0.058262481480446278 -1.8555784531626882 3.1326155229893797 0.050335741499189506 0.020270309243045966 0.9204789264277019 -0.87124861990401758 0.0036967635071063747;0.054423165340706028 -0.65607928815690453 -0.89829532207027962 -0.026918523181799266 -0.14673399824732891 -0.044207063815792008 -1.9253964347375025 -0.19725472814834238;0.037576293321390668 6.5330224442130769 -3.0738480994850481 -0.27936481447340161 0.43314819483002942 -7.3346462500147593 6.8894606002273582 0.54240255287972228;0.067050672699755523 -6.1399017051614484 6.3905592607527044 -0.2458529743907546 -0.028162149419218841 -6.8488485580480276 6.8351782528687481 0.0023144888771487356;-0.056468578047476868 1.0853120874612474 -0.40078513222353945 -0.030754401741009751 -0.0019547474795016243 1.004865482546506 -1.0887092773842213 -0.010953406465540858;-2.5180396908768312 4.3644749060843351 -2.2183726878746217 0.37857992717601474 1.444200862107287 -2.7249762731082092 1.4037364907459704 -0.1193994555469365;-0.032370073887997099 -9.9964786795191856 10.370752555310224 -0.2795373581476438 0.064648448961187432 1.5612403923108362 -1.8566893908471522 0.23750927296442284;0.19364731186362932 3.7544326159353503 -3.9886169799882341 0.31809500344981301 -0.22223508859462107 0.063409085533171733 -4.2768916556377725 -0.50017853484554975;-0.35429967293515319 10.0503500712828 -9.6739889468492635 -0.18577111364315127 -0.19735847832441733 5.9465963373883017 -4.2966223889480784 0.41432699187010696;0.18395818522924581 2.7972693181378938 2.0051798539496768 0.35383540402979802 -0.60292185499824491 -8.4702458748173264 6.7514627786982642 -0.078667241094975401;-0.13433015704659756 7.3420993963993348 -5.3809261878833405 -0.078278422459269498 0.052896295124312466 -2.8010026035265208 1.1959065704791134 -0.23872712742379185;0.0081971573652480454 -2.6416877523503453 3.5090398247665617 0.019103284014839472 -0.50488288448101959 1.4169928947271624 -3.9931502269561161 0.13179137650460049;0.027766529213037718 -1.2258693120691948 -0.91585258885067822 -0.062311950758372196 -0.27542580373862308 -4.8140464677148751 3.761872264276418 -0.0624300573805152;-0.0067324786113424706 0.30419588114563156 0.13542155441531695 -0.019164509600551174 -0.071958834923554288 2.0644429421602641 -1.3562581310214452 0.051210432924274969;0.18712106494106587 3.6635935684576175 -3.8451691771468623 0.35921789432840168 -0.26046587899221862 2.6570420497264298 -7.6540374518885734 -0.47552660607693459;-0.044933083829352211 1.677863286068993 0.66243649167601082 0.05862607440465567 0.30725351132135958 5.313637919907106 -4.179684897416216 0.060665954237130774;-0.097344242118742819 -3.7195498583272428 5.9642706482326266 0.15462103436486666 0.10078076928839043 0.47599755352058964 0.04512050467420653 0.13620591541551152;0.12018560318012814 0.58625128014432459 2.0515848254392983 0.18683359426455218 -0.043829441271361826 10.403595058407515 -4.9942463160878079 0.65471132590227221;0.17544294208841213 1.6238433503617604 -1.4176515681823776 -0.054879397117364462 -0.093592151093029749 2.7043603526025755 -5.4268596552423602 -0.10631919925841919;0.10991106848662789 -5.7224912995840826 3.9449839182681292 0.069809127061616377 -0.038279714402092553 1.5103638743825332 -0.051947537412445073 0.19453545008994427;0.37309890057041217 -6.032914258524146 5.8577982303807854 -0.30951778959958187 0.58403736719664856 -3.9851248531450048 2.6168533338223292 -0.69768202137602708;0.034754174215213707 -0.057325631861267545 -0.019632464469545714 -0.011051890413123685 -0.066258306047557267 1.519966578816778 -1.9800437602073824 -0.013302491098445562];

% Layer 2
b2 = [3.731796674265051;3.0410066413133108];
LW2_1 = [1.1372356555367997 -0.111702726294931 -0.24651868497395826 -0.075467308228473806 0.077743050701384028 -0.012078582423657851 0.028211366187332824 1.7337555671008642 1.3333110860026267 -0.020466632451155643 -0.40916123062583459 -0.30073024543357013 -12.566403935269397 0.012246206074266878 -1.9604556120269658 0.007293478899000165 -0.39813630936263639 -0.00013977452317518393 3.1630702936940436 -0.040845371536735856 -0.015460656571058844 -0.12459465120031182 1.3438361819613296 0.59988679191330585 0.026388973430275096 -0.090582173387718679 -0.019838088419232434 -0.076466763041368596 1.9647702940545084 -0.010163452802836362 0.27794651868636627 -4.0385135047729666 0.076829770478534051 0.22892823064891502 -0.11889485584093362 0.02064029653015205 1.3148631521286465 0.98569228589411029 0.94980616603901291 -1.4454519777432597;1.3135440202297997 -0.15142451829080333 -0.12695990110678892 -0.030157120116907795 0.068943133783865407 0.0058471879400662161 0.079152143304629274 1.2802602101401104 -1.2822205924987162 -0.0022929597637581741 1.1605194828464525 -0.15966422899286081 5.9262343901385943 -0.0020703494634657289 1.8613212973961413 0.01014633448746626 0.22763526557127328 0.03087553870146011 -2.9144703641749374 -0.036401563264948908 -0.020879514201336779 0.12672016990574084 1.5471198848427974 -0.34500495682835675 0.16782129619357389 -0.01846071833451959 0.015826275034011822 -0.035787921873208804 2.3086028637754743 -0.027396764336528774 -0.51116607308028006 -3.1623423598792781 0.017050336042035347 -0.43753504119301551 0.10135108344296469 0.058306199786014416 1.0423655428740535 1.2323183246500728 -1.0376624498546558 -1.0966627343130009];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = [0.1;0.1];
y1_step1_xoffset = [-10;-10];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
