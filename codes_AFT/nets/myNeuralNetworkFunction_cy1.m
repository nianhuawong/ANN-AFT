function [Y,Xf,Af] = myNeuralNetworkFunction_cy1(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 04-Jul-2020 17:11:20.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx8 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx2 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [-10;-10;-10;-10;-10;-10;-10;-10];
x1_step1_gain = [0.1;0.1;0.1;0.1;0.1;0.1;0.1;0.1];
x1_step1_ymin = -1;

% Layer 1
b1 = [-4.6259137369809258;-2.7063586484944619;0.11026337645327711;3.3471700876447086;-6.3907677191294061;-1.3048976749235282;-3.9195713832685337;-3.0125433209308845;-1.6211301562102221;1.3132582099614025;1.3535207976321435;3.6294222007805863;1.0825137889141996;-3.0294553338208607;1.6204770948442604;0.030023050475077504;0.059424071801606207;0.045224216792326716;0.029820311907688014;2.2287368432343149;-0.065324365065213386;-1.2553889357577124;0.048531306589975995;-0.6256364243717456;0.96555405698115171;-0.07385582459846915;-0.013160006351379525;0.024650256092037828;1.1044920459337981;0.081366726422099717;0.74253867858969946;-1.0709358777977203;-0.40306879336536072;-1.2158189255345653;0.99016860755567782;-1.5401763841968295;3.8062545785181086;-3.2207701090654997;2.8388353555275598;-0.39639666022650066];
IW1_1 = [-0.039128513759100113 -0.54202620592674411 5.4816791421067137 0.2164568098270275 0.1936622100612819 4.2773660578614026 -6.1269367753975414 -0.2811420942931141;0.10386317454048173 1.3902415184998835 -0.28693675085545695 -0.015813217045154274 -0.050860254574214836 -1.372438880580906 -1.0193120282687655 -0.064598950319666323;0.3423313386660804 6.8785433556378379 -6.217005151499686 -0.41340905772283587 -0.20366402690012303 -4.43615670314197 4.9052126368140945 0.11292627135773189;-0.23570545196994558 -2.316113590902674 7.890642254902664 0.84563026458311663 0.16608956362430113 0.82793260556451698 0.17477890740127852 -0.15228638673809392;-1.3945413097614641 -7.2084913784868956 12.130367786322397 1.4942701518957393 -0.31508138249704787 -14.790614072407728 17.328564052984571 0.91893089798170136;0.0063456025536400007 0.48501209147468743 0.81700111849652768 0.044747268104117811 0.013756448979524421 -0.061226368397416728 -0.60319573837057694 -0.028011208727501413;-0.048998420970331774 -0.18408654957415233 4.4627093364220753 0.16353273127088389 0.14535051245924174 3.5631704646031048 -4.702133324956395 -0.21928392432092525;0.15480884033199541 1.8744874595354732 -0.6468684087281007 -0.041570549563821869 -0.065162614864831561 -1.5474871490076982 -1.1370060042837471 -0.078408255903956878;0.094622857272714606 3.1261302980485914 0.28038552968820712 0.031664698737492579 0.25790799186159452 4.0052490394502742 -3.9007465499366587 -0.19080971271471689;-0.091842412962863815 -2.6895932327229715 3.0671765518041858 -0.056719881816114356 0.20436435019629098 8.6335135512962715 -8.6124511528454697 -0.38199961868558641;-0.017355475794252551 -0.32004758731003458 -1.0598852346956404 -0.05751368232433797 -0.092409320424121144 -2.1636506631734167 0.77305937621192056 0.018398417306838059;-0.01978667461872971 -2.1005571919816393 3.7627293459653175 0.25921304724890237 0.36976286009196724 5.4530340143165299 -7.6553545951043267 -0.29454203086182634;0.0057051963283401286 0.18104287853636064 1.3490401084834938 0.2067050158598274 0.042770543680669661 0.70476746375738719 -0.56595091737695813 -0.12834631506325206;0.34498284768373866 7.7829358696586777 -15.219126327365585 -1.0492132842584596 0.051961215500438453 -4.321523736353643 -3.2730069359454061 -0.076541350195198421;-0.093525236345930324 -3.0864903231226091 -0.31490030074113184 -0.047721498082567357 -0.26291215967132081 -4.0518566585008422 3.840867261180299 0.19483647009384641;-0.0012325506152510402 0.051618066548683561 -0.66699995044013427 -0.082731230655461355 0.012696875305735942 0.83389586908423563 0.43953808783674819 0.04394310078188858;0.33755950831144943 7.262824713373278 -6.7074380336323687 -0.47899162850875532 -0.25933994355047657 -4.8211818726173616 5.2605128206240455 0.1116620836086947;-0.14971882587148774 -1.8186225048245013 -0.34968484328523347 0.22297835916603204 -0.14841493250304427 -2.6332809950328961 4.6051036649918196 0.17348223649015168;0.23896986410932886 1.8094796163598903 -9.308051955562485 7.1928011415670214 0.55876936512771747 -0.75988974033454793 4.4241113337408056 -4.2937188716516879;-0.060093049139018279 -2.1046767793171344 -3.5169611299944474 -0.28588566738148768 -0.34449676678233881 -5.4424430260336756 4.0761006197506795 0.28259890225361267;-0.39450892318855535 -3.7999748997985381 4.0761826012869582 0.41609436417891554 0.13284934587180594 0.49717243364226188 3.4097409909456307 0.24482475267715817;-0.018475325188474372 0.24282651439302014 -1.8805601664272908 -0.20416472323322987 -0.018679581683624377 1.1472074750261132 -0.20460018825458295 0.056920296423529138;-0.15939631447309502 -1.9785629549934878 -0.24246878193558594 0.2235072789358904 -0.14464521388586199 -2.5341124467437863 4.5426844597931266 0.17439590753273115;-0.16792924070443627 -0.35139820745428663 2.8473231465831628 0.7962327987938691 -0.2843524053221364 -6.4082077818934531 12.061739679165543 -0.0013149066752875607;-0.015626611098635224 -0.74015168175036716 -1.2241779601137925 -0.23986822511823541 -0.035689609102739002 -0.88371376420549863 0.2598254220146618 0.17222184476887056;-0.099006585933117286 -1.407949534368556 1.0579248391863618 -0.15037558430242498 0.05748857873548073 2.1544295001210041 -0.24548490674903919 0.16474044254015116;-0.56806848136481991 -10.52612601174703 10.605498607285158 0.46318486169417883 0.02298218741033934 -3.5209564861386533 3.1309279344336174 0.2801287444478569;-0.13981941669820586 -1.4345559776676986 1.6781185289196452 -0.082311070060855876 -0.22462176236406206 -6.6546387502484361 6.6759562105580041 0.31547150823855413;-0.062485444160123374 -0.17016412615300028 -0.3029180342605986 0.073188183459176909 -0.084837397218710461 -2.7495980848941808 0.27667748530858383 0.0082283173910184561;-0.44915875173247161 -2.9688741060053196 8.2596731879277208 0.83589531195446376 -0.28643399159468769 -9.8966984923577215 10.052387753696696 0.19376658304955377;0.12492451285851584 1.1802900905470546 -1.6726551816948132 0.028795354954028043 -0.14931788628491688 -5.580608243402998 5.4634591825952485 0.20621543448111521;0.016741137728395396 0.83033613332007883 1.4013116752264898 0.26709702529745671 0.035664341370088018 0.96501645476865894 -0.24768468522944781 -0.19195925195233499;-0.051321305572150158 -0.82054865587543613 -2.3324061606455548 -0.10367517111919991 -0.095587694642246299 -3.3286537003700372 1.5766498599258736 0.18033156157540245;0.40444059108551189 8.1420081146699061 -2.6256248520554135 -0.51303777015312291 0.44194057554873895 9.2311621683727676 -3.8375385402353217 -0.068414853527347899;-0.040814541654217953 -0.053168863276815727 -0.38406794267043393 0.040421857734474403 -0.075575355383404638 -2.347463259735576 0.20413940712878087 0.0035136340222848787;0.014055059671384691 0.28163560499681722 1.292863436228975 0.065855555652992129 0.11283486831135622 2.6198853664256982 -1.0554720920190965 -0.016506198578399675;0.043913241085560863 0.020986334538247518 -4.2125572198100745 -0.15167349708610639 -0.13649491442829034 -3.4230268539638722 4.3992210118416857 0.20435476794643742;0.21858793877714922 6.9230469007298217 -9.3044523383006315 -0.66809737455358831 -0.56531346600526045 -14.275426147299573 4.9855411130234559 0.27554718678574264;-0.056940553826831712 -1.1965401311767476 2.8374068223916313 0.5277451792045148 -0.051130167722671205 -3.4432650401566014 0.42700098508772283 0.010787505439168598;-0.037812178236399319 -0.57476102273009733 -2.4974325157617128 -0.11246649891956852 -0.092264903478196686 -3.1772621160594721 1.4553319889472673 0.17280693155634047];

% Layer 2
b2 = [-0.27263261117026744;0.003507533277326134];
LW2_1 = [0.5608473430959775 0.83266008527282409 0.15278858202259027 -0.054426252606811082 -0.024761317140487019 -0.43143014838618227 -3.3725337861540328 -0.66051482751690271 1.6313907981186244 -0.086634051759555034 2.8130033860673822 -0.034235367742000034 0.8574708803020501 0.018812989198855282 1.7171684317195861 -0.10853659182855223 -0.21910644066093909 0.22472495633748674 -0.034451765558186964 -0.12325608932404088 0.024638721220563074 0.21505416504994385 -0.13335524207547442 0.014158451998024645 -4.1808022663810318 -0.13540810583847035 -0.029994595136125013 -0.19666498612744884 0.17685916148208833 -0.0030869340859746726 0.1796544717917862 -3.2162776565845426 0.29173183327810742 0.015534051147689869 -0.3142269890306878 2.3051435638787949 -2.9180434824299679 -0.024803211890713432 0.072900990053646419 -0.27437699570911706;-0.53128744553557217 -2.65188043416862 0.27689192149112862 0.034267150654025851 0.0062092593668062381 0.81944670660427654 2.7126359604736221 1.9688708439655564 -1.0523700391796873 0.013512811821504968 0.87489315164740811 -0.070601541631519535 0.01680025136396331 -0.019325433218090458 -1.0415593341237819 0.86048383861577371 -0.34470954381454988 1.8180523329714597 -0.00081977157096381026 0.0065432074214835413 -0.054120121350740021 -0.18900751461820239 -1.8384201947168985 0.016464763734198067 -1.0388644067224706 -0.067982091443049508 0.11323125824079039 0.039109306481502543 1.8123170106238822 0.015823536211909014 -0.02673138737444912 -0.88310338789515064 -1.8008333390163052 0.012747718901289293 -2.3654517251944842 0.54022314141254291 2.3176116367925936 -0.0074433594218834102 -0.1135576771637125 1.9233098365550367];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = [0.1;0.1];
y1_step1_xoffset = [-10;-10];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
