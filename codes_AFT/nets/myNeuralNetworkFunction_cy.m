function [Y,Xf,Af] = myNeuralNetworkFunction_cy(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 05-Jul-2020 10:39:07.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx8 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx2 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [-10;-10;-10;-10;-10;-10;-10;-10];
x1_step1_gain = [0.1;0.1;0.1;0.1;0.1;0.1;0.1;0.1];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.2498611949566176;-1.3493034200287792;0.82178424716369336;-1.941719354277796;1.1764257564715361;-1.709714283442259;1.6567142205457417;0.97613247127908376;1.1765049745194411;-0.04118280563472182;-0.59186131616855964;1.2479923995400151;-0.030173049498950208;0.17106580053004106;-0.017058251675338577;1.1515717885649002;-1.0661848699743794;-0.50470334572507969;0.18288527204763386;-0.041104675599009773;-0.47863655771982122;-0.03248704214666371;-0.038029155601447491;-2.8429278880308768;-0.086746238164009615;4.0080546920720019;-1.1837234143143898;-0.83102079039190047;-0.98835633856715199;-0.8257721527795906;-1.1500477152385784;2.3634902412467276;1.4640946206128358;-0.0016502415078405526;-2.3206077100727054;0.69085385971710866;1.7125875390962964;0.014511811518676471;9.7306650778229393;13.402554391280729];
IW1_1 = [-0.069631482721493207 -0.39353029867373751 -0.57342615923482643 -0.02849989446146544 -0.056819981881686507 -0.89398491783688405 2.0851212431905113 0.021452467755550902;0.00083436716068293075 0.26823221587596413 -1.4393217094485968 -0.0058157715520821881 -0.21192601082838758 -3.6127766290343879 3.0549682561176543 -0.041154458723124919;0.05345689479293083 1.57019377623832 -2.1244992172124246 -0.014250667095149805 0.006500755364459195 -0.94321904708264626 0.29956140702567108 0.0046729936186301422;0.09625573430948979 -0.83713380367345425 2.5471118967971451 0.058560671301882833 0.117318862058972 2.7045413232020561 -4.6754882032902714 -0.049656675800814253;0.083845432263326317 1.2394502765943385 -0.13689064315628435 -0.012269836971274784 0.037361776281075634 2.0816260728267171 -2.9992277636900488 -0.05832902609149019;0.01841650745822912 -0.28288369009873604 2.1380202630275789 0.0048386708667733152 0.068877144693285028 -3.1825242608750171 2.6531780371637366 0.12522816870691938;-0.33739813887044495 -3.1915313114311625 -4.5563362341137781 -0.2996812592030389 -0.036786160575194363 6.4382459714583291 -4.7531124372412217 0.58246439717675791;-0.082000358910228208 -2.6197800034417384 3.2214255337696924 0.018987575175160903 -0.090660374783930103 0.67852284623344183 -0.068123797996447674 -0.025601262548825644;-0.099716331589893847 -0.23194555182694235 -3.0440787264355103 0.10039781922381989 0.14153516129918919 3.7795025142516465 -1.7225847850445202 -0.087304288335943669;0.12049117027503749 2.7964656683377762 -3.0037158686338592 0.05949423157941456 -0.39969299924338769 4.3097472625847706 -3.9173791357394592 0.013825687113232231;0.052598698712171835 1.6856025439611635 -2.3691983138227579 -0.076729538508643544 -0.02298144387648595 2.2890443740139492 -1.7701455899267313 -0.058261773126208331;0.48931040685723509 5.8965645734234027 -7.4589030352976273 0.16314113145514769 -0.093438722166511196 0.051711327291181095 -4.1011444609422831 -0.028992570440101253;0.32304483636154785 4.3145924437873253 -8.2490670322277282 3.5708068982333514 0.4239007388619242 -1.811866617615993 0.89902374621371983 0.51951803224722515;-0.28736027814040277 -1.5795656274431404 -0.20164795773577918 -0.029435661817123836 -0.15918798379923743 1.6705329111504623 -2.8347765078337641 -0.064832694262951615;-0.011340462598726255 -6.8101724722200396 6.6916009600689188 0.10838990204753929 -0.1441315592661101 2.3979068702669073 -2.2596397090768607 0.027952441782316213;0.42626576315823117 5.5775350800721428 -6.8487981698809266 0.14113572588561449 -0.083820830258402437 0.30780919275846569 -4.0111266427118295 -0.034950242303203274;-0.36714946220565509 -5.2181589705820519 6.1651727575551787 -0.12266866322013655 0.075199827531478511 -0.59066110164065511 3.9779490115392919 0.039285338946713905;-0.058878348282188256 -0.2962468873178995 0.13864773368282965 -0.038196677655522433 0.011702693012756707 1.8919097405333605 -3.4027124802714344 0.02076151776332516;0.2739157741690178 2.6247863160416394 -0.36143032877422165 0.010269765333815992 0.1626695655173078 -1.236592467483326 -0.30121506198486397 -0.054526399268612059;-0.21560652678691847 3.3261137463420458 -3.190631313569213 0.056170900861982134 1.0437137209960432 2.8583787629227975 -3.9163298697546676 0.01613868864286918;-0.059257528886280185 -0.27774923963292386 0.051714995607787535 -0.039934636463389156 0.0064691765979598788 1.7383985803698765 -3.3124244222652726 0.021034474087007433;-3.8091847708431845 7.12048858618917 -3.3309241972257109 0.014415985702746726 -0.6845986079709131 4.559081808814982 -3.915811597096257 0.041940350826101765;-0.15648347923102163 3.3275560168305334 -3.2544146507743745 0.057049260296974519 0.21816733500132587 3.7791626058370427 -4.0114901209670055 0.019064910008992478;-0.06153335935513525 1.4732512660275563 -3.158325430599179 -0.1796550272423314 0.054524805991078298 -7.2413634478686637 2.3807588969948101 -0.07917352169349276;0.31027856003999471 2.9627942830866254 -3.0041418097558537 -0.17749117229275696 0.13140750848474708 -1.4172607307605813 1.2010446509316617 0.015716643525640922;0.39586980935600125 5.7537810902878705 -3.9869111306771003 0.28081411596104472 -0.22008885370773032 -8.343771538129678 3.2421395199545735 -0.13069630895858192;-0.29845564704287147 -4.7284806803244717 4.5586781960449381 -0.082996705374080826 0.093001543582042975 -2.4890660233273314 6.1619165570477747 0.050517765198558086;0.080254892632579025 4.4302581544844841 -6.0014426260761473 -0.12128860989550924 -0.02606667917729134 0.59826703241018286 -3.0123050641606066 -0.056148427489459626;-0.084175150765477977 -1.471718444719371 0.50581267372407457 0.020661650375527429 -0.030901075184558983 -1.6388137697353551 2.3555642924437543 0.04655759216604375;-0.10332180570615193 -2.1304645146907069 1.1846986863498681 0.042690764888580153 -0.024549308257967379 -1.6457696522173275 2.1636361230611376 0.050113726048207893;-0.021312800343830218 4.2888769622777438 -4.2121682041204496 -0.0028631525947256328 0.054371649976359869 -7.0790467132476271 7.0596291443861912 0.059217178622056339;0.0031598778099139299 0.42024280591665469 1.1610798576093917 -0.0058350803433231783 0.022882541376091678 5.3370926870990782 -3.0150080132750654 0.024759765814510584;0.13902519079066172 -1.0303346523068642 0.85535257429156319 0.066034981252170194 -0.077283419073255324 -5.1299859532014462 7.7260984260535954 -0.0079581640571760193;-1.7223601317694111 -2.9532152430300509 4.372270430870369 0.350785363236648 -0.72918735664605749 2.6762747502841724 -2.0197565474480599 0.040025630140960992;-0.12546127187597006 -0.93898046570130078 4.1531300785297987 0.027626046287454336 0.29203681513396534 4.959768670334002 -5.7362176995572707 -0.10542256720477672;-0.003251564027526581 2.3956428021208742 -2.2413431349428432 -0.016297521897935232 0.021073362017299847 -4.4186220538019629 4.3851637605897329 0.024982238739845102;0.21925407643993172 9.4309630585095992 -5.7223778397175273 -0.52743342354573231 -0.034992887324764757 6.0244403864251321 -6.6682161359859276 -0.1554760629514407;1.3053832086640338 3.7156667051835872 -4.6447863191474763 -0.44089597380443551 0.59019276977170076 -2.6068195850969134 2.1441717172378167 -0.076573139022390407;0.0013980456822438579 0.08439243726577865 3.8136489287001494 0.21930412593884593 -0.1246416296150983 12.414391496123677 -2.9041834976571486 -0.020600050334435262;0.079309842615819928 1.7038322865348654 6.2405070216632614 -0.028389855255413904 0.031361436454053357 26.881370880334298 -10.013597866570018 -0.11247595097220474];

% Layer 2
b2 = [-0.31614289262400319;0.10785372843275547];
LW2_1 = [-0.44849191600649718 -0.09800800735541268 -0.53843509145676183 -0.075043857002413186 -0.54355735532340288 0.11071072522458189 -0.0047678267608289998 0.30304127435354905 -0.024284435712656486 3.4785247371213992 -0.25466798192227069 1.7237630815059677 -0.11236951914660927 -0.043521677268177662 -0.30162445127952098 -3.7948234813250825 -2.2414924252140982 -2.0691434578947465 0.073104784182358204 2.5265929252909198 1.8629494303472491 0.20585574011172689 -5.1815434085883245 0.031025656966705346 -1.0159592217636968 -0.027108736913648856 0.14046849458718269 -0.081078106044343998 -2.0229106881964847 1.045134153218346 0.44139548842137105 0.14538196008020965 -0.098289766652635488 -1.3533598075317164 0.039832872296572307 0.86850887588365344 0.01527034858334154 -1.4489620568465671 -0.036125887495205941 -0.02214669707853107;0.70927175250820251 -0.24283158670697175 -0.7780561259391332 0.19464051588654102 1.965672713575277 -0.067038492269215724 -0.0025863170482182695 0.62113440131056585 0.012599448537897236 4.3070111872675163 0.18622369770039726 -0.63004107306317669 0.056298345608430195 -0.012635682998274162 0.53716700283875352 1.3319188636167383 0.72664487391913379 0.93891192456339934 -0.013211043770373906 3.4401312846996648 -0.94058760611413572 0.29546977988818229 -7.6970637133604107 -0.05614958401941296 0.83544665628254577 -0.0073397280623444475 -0.014521854972508404 0.023919488585266602 4.3556433941587605 -1.8481515391409764 0.07433921540462457 -0.25924048803659422 0.00088830264825708245 0.59431778655602496 0.029567847068343561 0.2195438612377818 -0.026659627444865726 0.71331455706938474 0.070251476126834453 0.043158835882592464];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = [0.1;0.1];
y1_step1_xoffset = [-10;-10];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
