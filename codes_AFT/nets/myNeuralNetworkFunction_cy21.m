function [Y,Xf,Af] = myNeuralNetworkFunction_cy21(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 05-Jul-2020 21:23:52.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx8 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx2 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [-10;-10;-10;-10;-10;-10;-10;-10];
x1_step1_gain = [0.1;0.1;0.1;0.1;0.1;0.1;0.1;0.1];
x1_step1_ymin = -1;

% Layer 1
b1 = [-0.58038289556980538;0.0015098561943051845;-1.0384262381499645;-0.41021549621016445;-0.72059099748409039;-0.88990382047834593;-0.75790410396470109;0.0088649848380002606;-0.16935544726847268;0.0053498924329054825;-0.23525877317540619;1.5026043595687242;0.00089544942457956138;-0.35551137291595392;0.0012969763413798734;0.56577326502063674;0.00255269381630505;0.64197204121996354;-0.80518547453722544;-0.0064907438591907413;-0.58933735267844323;-0.52811648867383287;3.7684177591549634e-05;-0.23262307246412478;0.031292642043592798;0.0084397466685166966;-0.67822343697675203;0.0011119557585888287;0.5822049175953331;-1.2372167121504507;0.49008972575948323;0.0012938077728025111;-0.89345936217413824;-0.23117125890982468;-2.3605985365261564;-0.0054899781442398201;0.00055560221856174518;0.0092880580134148231;-0.0035173037658594477;0.0011506206664903208];
IW1_1 = [0.2676319818473909 -0.54540043902040047 1.876560588480785 0.13864171854783303 0.17466168161168269 1.4521948475428463 -2.4366233166402784 -0.34355926682552052;-0.065704251807096034 1.1241506070963103 -2.0370263867422418 0.97780751939485544 0.11513961196598789 -0.57777984268624261 3.4110013782066493 -2.950245836211804;-0.41159168347356867 -0.27603925371654647 0.51154389653896581 0.22597158086362884 -0.10999811953277161 0.77086041346293299 1.3758711534119015 0.57187929553429906;0.33213693055120536 0.32874310190192962 1.1836626232521132 0.14245868990075533 0.23554746572519372 1.2916882680127395 -2.5784185702938336 -0.39262104950546667;-0.1185260094816255 -0.92836852838353368 0.76305951914349779 0.2716983768562185 -0.0096148289135964873 -0.22294195498604283 1.2772497873408606 0.14191745628818134;-0.2738025746477587 -2.6740386763779687 1.3664148886636414 0.033872153808049012 -0.083511434843621279 0.8242288354178543 1.1132094800581267 0.42222342181344302;-0.25140670160391154 -1.6055660868626285 0.46944148755708776 0.02675159280440793 -0.064055214632627061 0.18150110797651683 1.4501489575696276 0.36488879442070371;0.095482735772916064 0.40404338783007765 -4.352835786069484 3.8485999334724768 0.052931182328817578 -2.6616506947496341 2.5193403453062579 0.062786677433949722;0.5410749107339643 2.9663844812320916 -0.798618825799426 0.22028946552034481 0.55999982570689422 0.12393376081952473 -2.5209167750823518 -0.42419471763635308;-2.506409307137941 1.2324836402750061 0.96601869892063652 0.29450731159256227 -1.6433183676355154 6.9458648044668756 -5.1079434361581146 -0.19315383106273162;-0.0045976251769123035 -0.45817654551424358 0.66672289937707963 0.06294831858477247 -0.04798418805023244 -0.60567264869250714 0.24451718302777445 -0.07582400276301797;-0.12965193274560557 0.6954957725969666 -1.4853027225104085 -0.062552333066605015 -0.029654977900420723 0.13643886580039458 0.69138698451412606 0.21609122726317234;-0.027854309694403345 1.9918560852808191 0.087318528328265102 -2.0507199441826427 0.094150622374142512 0.30770951090748183 -0.14986148124059198 -0.26478681124924747;-0.11612262425160869 -2.0479393829054584 1.7445761039692003 0.16384725534675743 -0.22662216565181734 -1.2794289057129247 0.46859504704507104 -0.077711868506852189;-0.089838127589657576 -1.6367541803190229 1.1225457509310837 0.59958111577536499 0.041469850945956066 -0.10673262701835257 4.5973683397584173 -4.5350248240770723;0.070534969971138645 1.6610080720038258 -1.3276556693597217 0.15377640178375906 0.14069531521809836 -0.30358363800566374 1.0479686130224011 0.092113722475582346;0.41909118920066812 4.1347742188656227 -4.2398361707410901 -0.317458881719834 0.073956880592906032 1.8939869049248554 -2.004867150570977 0.046837520791958298;0.11675509122565284 0.80356859651303225 -0.58144090430107098 -0.12068119590574669 0.010742354943523434 -0.21411060810586785 -0.65082378845583166 -0.096404102835804917;-0.018290722992696993 -0.041080873479993403 0.092960684260502441 -0.24809093723130607 -0.042101912868110568 0.91848805179680859 -1.4507468764954723 -0.1232132736220119;0.41115975434246005 0.94794913446490858 -1.1461670316622976 -0.1980454157169993 1.1545987057044695 -6.3109728386915291 4.9321211696442324 0.22716725415846034;-0.19646827541329645 -0.57445286291639597 -0.30556687183502057 0.00095442691029078261 -0.039208855338358155 -0.053210078977826571 1.2819844831275038 0.28243757702955891;0.11616337513490423 -0.15315465421874078 1.0735524148659272 0.11887483010366148 0.058423657691125945 -0.92310235616543657 0.032421622900933103 -0.25050572895353984;-0.15403493027151688 -1.3908439109550961 1.3536962421346532 0.18332246264101915 0.11901459127668687 4.3229739230320243 -4.3379053936548395 -0.099226288927864156;0.43809742303234522 1.5729113088238886 0.30815796454057715 0.17735003919223657 0.39113241592109721 0.8740482899033587 -2.715586704023603 -0.43216472293377589;0.1352883192063942 1.0068935339968352 -1.0076251611055662 -0.11852548420212752 0.10347522540940583 -0.55522403548033616 0.81942851092758062 -0.52645651450172859;0.40022749931631252 0.5973292600305391 -0.19943638290078758 -0.79015663982484041 0.13621965577501069 -5.0237967287060226 5.5430612707436362 -0.67417530046197249;-0.035988065795946586 -0.53620656291361546 0.4861967479228112 -0.2021445266568877 -0.08047594372260343 0.38622914126699198 -1.0280045316278872 -0.13198565948260829;1.0007004666013202 -6.7930939527591132 5.4972912871511657 0.29405232068996956 0.3587565866128426 -2.2595087851503046 1.7797992028656187 0.11826590841177477;-0.16700763487921144 0.74639864532402334 -1.7318355117799136 -0.1117787054609727 -0.11937652008663138 -0.78386564028479166 1.440019184518871 0.23494446218662698;-0.65835831192285998 1.1815130753307792 -0.53668574020410476 0.017138188197817286 -0.27143242601848316 0.67194033572576717 1.9369339104978742 0.95234226314951231;0.06344144840619631 1.4191010341143337 -1.3492287122342868 -0.072412574272619865 0.15450567324829609 1.1829802008685346 -0.37622589527849637 0.15985386982423039;1.4643291387273856 -6.8689960540685444 5.1194739323400196 0.282749880723703 1.3757621050568178 -3.2726032088024066 1.817949300786952 0.075208592123768431;-0.2365552619574805 -1.132227696079843 1.0700161876782068 0.37097739771631855 -0.03274465346563657 0.11882759335292736 1.5940398172103551 0.30293969482920685;0.086031863790807295 0.40234147093311601 -0.47505691270926331 0.1451997463170201 0.060629129044080868 -1.4364918166081873 1.4710347609851313 0.12805451134769594;-0.0076984068960916007 1.3887471041669845 -1.7877418804100753 -0.081547545983922554 0.14959416059356193 0.9915041934261245 -0.2181322408051983 0.15303861295181373;-0.54183189406508758 1.9624816225365176 -1.2406448676585506 -0.1654341565080962 2.24354513584783 -7.228539324621984 4.8031384013686456 0.18286729014501685;0.037567403531333927 -1.4860187883319873 5.0955448375353471 -3.6429595505446035 -0.058209615070240736 0.36606648250754464 0.51308242228949041 -0.82378273931543278;0.27706567583207703 0.94084926856363305 -0.97979481775579824 -0.23949003178158132 0.070333617775866733 -3.1313284968167676 0.0011806799987845442 3.0424617863255552;-0.021399751755070258 0.25571084270323852 -0.29729346914882138 0.094025842796676237 0.09201994737992876 0.28998674295961524 0.80877280680401631 -1.1140877594527776;2.1647904325586191 -7.4648380271803312 5.0377742197954456 0.25935464384329571 -1.2768635041587648 -0.51659623851316916 1.6593554771531567 0.1320091272301106];

% Layer 2
b2 = [-0.23328076631650663;0.30528890000298448];
LW2_1 = [-0.65819512503003108 -1.4490230176656442 0.82798735974795323 0.95043177086017783 2.3337844175014828 0.49557154990395796 -1.1284318767844972 0.33772330566262676 0.29666885579167485 -0.79150630086539842 3.1073053382999785 0.16357489642716663 -2.0907693657165423 0.31207057519880194 0.79719253340979246 0.11183806003958717 2.8683413777607583 1.4583807847833159 -1.8269868720486271 -3.6277940505059481 0.94333295085665425 -0.34988578392914288 -0.50190108529926569 -0.74121632823998784 1.3297306747254671 0.25900410072389501 0.98346087706603014 4.031194169069197 -0.4056970293069877 -0.23509183167666731 0.6902211000776538 -2.295355716862828 -1.2524284296910875 1.8248021825174243 -0.50529220280271248 1.3953083853251385 1.2243778699153567 0.59505385634699748 1.2025210586120931 -1.1044866724323685;-1.3391935392540764 0.85304695495806993 0.091429247158109753 1.5418456502595184 1.2485854851095397 0.60091147296548064 -1.5516353275486283 0.81546903846938545 0.43860805399882002 1.078302250033327 -0.13324483305907953 0.46955472587448255 1.0737851800872227 -0.39471006365212596 0.18581231904317824 -0.37325753107876475 1.2753742923665301 0.87396678107417758 -0.28414682836678751 4.2406308597856608 1.426357425719651 -0.29226842633227551 5.0358338245501679 -1.1252779705210501 0.057532425061621803 1.7812565205670441 -0.95390696268528841 3.654382676229023 -0.9727441459991788 -0.019762091081019211 -0.52933776198001226 -1.8470839897021214 -0.32549324760429488 1.0086821024617767 0.6611250582934054 -1.8832856852229536 0.27459200921822446 0.90421630014037302 -1.6681618220129164 -0.85752861691449656];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = [0.1;0.1];
y1_step1_xoffset = [-10;-10];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
