function [Y,Xf,Af] = net_airfoil_tri(X,~,~)
%NET_AIRFOIL_TRI neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 06-Aug-2020 10:30:48.
% 
% [Y] = net_airfoil_tri(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 3xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.keep = [1 4 5 8];
x1_step2.xoffset = [-2.06857674966266;-0.352650533504099;-2.11498324298231;-2.04639447215679];
x1_step2.gain = [0.530096354493371;0.574161151742915;0.446168222344122;0.453101152519521];
x1_step2.ymin = -1;

% Layer 1
b1 = [-0.87652475360805781612;1.0671024047556609826;0.96156382746857627097;-0.5653982223041165156;0.15405157610302611104;-0.10407352160579086409;0.81004349202958148002;0.7444305576046221784;-0.028647516243371282801;0.94385778185061097734;-0.11666244246353432712;-1.8597191413472144994;-0.46572421698841498516;1.0226112887518066241;-0.5489578876122949147];
IW1_1 = [1.570006445921036109 0.36470138583175060187 1.1614629111312753107 -0.15034518338878755106;0.2391276723328542575 -1.2405821537462542459 0.29080616451963636759 0.7317907394944537236;0.051732344807601242376 -1.0818591215674280281 0.15915612178187768522 0.63629009261041902246;0.012427918744472360099 0.21690665777357162614 0.051507732313824189374 2.1548062636881226695;-0.26404861442922561432 0.16583026219034466275 1.0389071291340410408 -0.17248620497620437142;-0.86116728564886724229 -0.55793406964119007796 -0.45891030916821740071 -0.57362927845597178056;-1.6228755417440294817 -0.35523701587961853399 -0.93535902276554439005 0.13973789324984384197;-0.90235083999549137168 0.7664820713115686468 -0.61187286011925434703 -0.57352591107677652893;0.26288383828381384211 0.56131866277728315051 -1.1061655373852337103 0.65951702090019903579;0.41364031112864957374 0.088805215303075446531 1.9297529853393751154 -0.080040899878598997796;0.94646021147390357875 -0.044526216202569204872 0.6099098931912486643 -1.1331178636010637018;-0.14118566393346185239 -2.2723128930358451605 -0.16742112299102945849 1.4971588036654110976;0.016273219042482064967 0.067809338947214345406 0.072833321672154269222 2.0184751861808871709;1.9338022223797832755 0.26167808424163485626 -0.88397751502825205883 -0.1040463543584947137;-0.1269592447453039008 -1.1289427109618446199 0.058639454528089079988 -0.62487722635513975877];

% Layer 2
b2 = [48.516571560065578694;4.5401197178650720687;-24.421853883628639181;16.139446444026699368;1.3921424208729913374;-0.5535487171327350131;-1.8654282215582078663;-2.627265149224646823];
LW2_1 = [-4.5183778737508761836 -96.960275559154425196 53.926329935425940221 4.3877048566620517889 19.794502505512639345 -19.285818269351835852 -6.4052752011903377749 15.828317722847071281 17.579200289438851712 -0.56853713482989465255 0.99354037672726125408 1.7342711976031719434 -1.3461700260391704642 1.0944125652589222764 31.207494454996247413;8.4160363033089051754 16.149165499468093543 -20.014892560902168839 -1.6594684532815884292 -0.43780716448478484981 2.7924420226641766263 6.1982659807881015368 -3.5668445068381133822 0.31753758642408497215 0.091786234850912196137 -2.0158035202764823524 -1.9743318233214601776 1.3702399457108134229 0.1158745285457799673 -0.082780137034457398904;-20.779399048283398344 -40.886444076452036711 66.039363956559213875 -69.386693275350054932 15.352545057998675304 -5.8975492283892965162 -23.895746965125621131 6.4232971988594007584 8.6039898995080772437 -8.9650421907300668067 2.3667297643918896455 -6.5302037690106269352 62.839441499454508744 -2.6472449150142001173 4.1391563832662034983;-19.895130604804244001 62.595537880199550784 -77.517869461766053973 13.968014478522590593 -0.17906820277537302544 12.433262095713539352 -26.20805952777303105 -12.950327139684336686 1.157353625654912177 0.54163177624532610199 -8.4406278064647892734 -3.4814607479376262766 -15.076133675102697751 0.19279187620434257155 -0.78993846789317712087;-17.340309516777935528 6.6908803367683313823 -8.1229345691326688694 2.6014642534148810782 -0.90917340145858449585 2.1826015999070706997 -18.56433439529375562 -0.92005295390801611344 -0.058280218054775470571 0.86657696874168421708 -1.3667357627997194225 0.04341820886780194122 -2.849100962882529231 -0.14671856609327998955 -0.5463496132254065385;9.2507318213361973136 8.5935655545880820227 -15.970533950087615338 -3.7508425645673355575 -3.3459763783574323348 1.4874923689582904007 10.407385158695779737 1.6090233602598913443 0.49205683030561347957 6.6530427491394998896 -1.6096903654302565645 -1.1804231276813836882 6.4707866662121045209 3.5785784439160486237 4.3276372579634241333;-5.4900634704051611834 -11.946568490736140689 14.98702842078349029 -4.625946728446866274 4.4329771392693739784 -2.3215681446030713708 -4.0408145943546260881 3.2099396857874267219 0.10110906359396276688 -1.781028748408004958 1.7072069128690909867 2.8715138156279467196 5.3358219861300817399 1.3079410639612967238 0.66998764561860268962;-16.993418448669640242 -8.975657981936334906 21.182212576577462926 -0.65395832813550136553 7.6103838096559321968 -1.8948094802203860887 -17.607587653474062961 -1.9070326376656738798 0.49397568307965245005 -9.2981478728993849359 1.5870103430237414432 1.1766305847589357825 -4.1198985325242851729 -3.8642211062221982765 -5.6014960171588903393];

% Layer 3
b3 = [0.17437573728950808705;0.2644374247500027586;-0.33029264099282207301];
LW3_2 = [-0.46297299701106398029 0.43454774359711023646 0.022454209782774733201 -0.31492971058193613976 0.076231982859506497441 -0.052077060258735000109 -0.50098861143925987882 0.049702245271096741341;-0.2908103600718275894 -0.80446695286988934015 -0.033442122103598787008 0.21999447459997348298 -0.74229977579510619812 0.044261935363230794915 -0.46794974740546774195 0.019576158216708695881;-0.26681238288884406851 -0.40322941484899937903 -0.18268111842124551414 0.1893187361189023199 -0.42587238266790428121 0.78636715892441744202 -0.37527442130960153577 0.84893871469420378872];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [0.972302612021623;1.00836643332254;1.634651352754];
y1_step1.xoffset = [-0.352650533504099;0.38422497046037;0.000259515743353245];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    temp = removeconstantrows_apply(X{1,ts},x1_step1);
    Xp1 = mapminmax_apply(temp,x1_step2);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Remove Constants Input Processing Function
function y = removeconstantrows_apply(x,settings)
  y = x(settings.keep,:);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
