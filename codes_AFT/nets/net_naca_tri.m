function [Y,Xf,Af] = net_naca_tri(X,~,~)
%NET_NACA_TRI neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 06-Aug-2020 11:37:30.
% 
% [Y] = net_naca_tri(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 3xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.keep = [1 4 5 8];
x1_step2.xoffset = [-1.98865201334518;-0.280510458898558;-2.03292502281604;-1.88837967365199];
x1_step2.gain = [0.621485666081241;0.595098242707543;0.512704197323761;0.505988842009393];
x1_step2.ymin = -1;

% Layer 1
b1 = [-2.2725778093188107043;-2.5000777049672926466;-1.8541430920317036879;1.2758490711343046797;-1.1043326704915770176;0.51230288924845956977;0.78083752231549918843;1.8796579967922633081;-1.8908842586293748145;-0.74757981142318397083;-0.66434036513138061686;-0.43780215268816902174;1.0537025461283930916;-2.0918819866063294022;-1.7245913691934673384];
IW1_1 = [1.0190512625400591773 -0.27363152316638295058 -2.2662385901811781252 -0.0044074944299692664362;6.0459976140322257976 0.25456445080772449607 0.52178082810058801222 -0.076137683307750517181;-0.93043367335421833797 0.10718731159948211018 -3.5257891462975932129 -0.035981641904141582755;-0.67407945919060485718 -0.027587238162719407431 -2.7158379800937075821 0.085381207058740318794;1.9454593470312782078 -0.021772281403671680383 -3.5243328175040349315 0.10101347189584855557;-1.6698118361368037288 -0.052907389816572336638 -0.16047664333681099791 0.077363413749632473082;0.06982091404924349598 1.8210450727295059981 0.16161302716012090896 0.12954200677926369645;0.22649568115532309198 2.3324401422016758367 0.164866341325885013 -1.8589615356225765996;-2.2434258902135706393 -1.3181386724434414059 -0.51133837104137014329 -1.5921506130135787416;0.23570784557793175717 0.73789179435658525108 0.03227906799117098019 -1.1465646631467938388;0.14550223305187731659 0.63892093096408031361 -0.035111524744598450465 1.6733742640756934517;-1.5025107496763958626 -0.36579791240664544238 -0.22075331997566605136 0.26090300846816877334;2.3973734229345931013 0.35060595802044391966 0.47101845217335358562 -0.89575539077261712162;-0.37120189712179391117 -4.5743441879656847604 -0.26152490341741946311 1.6733483137660705165;-0.9453882147102193878 0.21069838117092812291 2.7794227235911841412 -0.13780247113404625603];

% Layer 2
b2 = [-1.8724504388627924989;1.0091962431470944406;1.3284286769593345312;1.1163795342395028687;3.2508295009937540065;-3.3782610618638413413;0.1308599164171667939;-0.33880847746270409404];
LW2_1 = [-0.054612551107517337545 0.33804092217729891923 0.34703594800313680713 -0.91447192715468150759 0.48928607572513244106 -2.0486076549912164424 -1.9168637428682782087 1.5159319538688873497 -0.72370747411404268146 -2.6606431819280609297 -0.48574914091598547783 4.6704166101177566617 1.2967501760684081447 1.1704577671042686315 0.48634701849797051798;-0.03378998534486699068 -0.56217670847014633573 -0.35204624800092620962 0.15348503551688219559 -0.3008939611389593316 -0.21779764055286343627 -1.174032654717060975 3.2124705812761558121 0.17196318283187669862 3.3128450645109852601 2.2185519588803135349 -0.96707817062907008854 -0.48173444199376724839 0.21442362494314542998 -0.47834522550016567166;-0.19197484256380661916 0.10891986911758461121 0.40980420867415834341 -0.46527021560428599711 0.2352739977152636941 -2.4445122866462907218 -0.12377353239898326864 0.5031653021099140588 -0.66148598357527665925 0.17459373464165467427 0.25506286203629702225 4.4997013011432303031 1.4120816489416641026 1.1772946911144885895 0.4738659977658988276;0.39677162843851038199 0.068501119145154609757 -0.072356328288440713292 -0.58637607395213409145 0.43222188378156123356 1.2150460982443092028 0.36433218190859689711 -0.18878296056837970407 0.30111579591955650592 -0.58824367667090737832 -0.4723666666792031843 -0.81409628694736657639 -0.55920251821824362715 -0.046193690980073170982 -0.080220958172901798977;-2.5469147639590405952 -0.31990018201550235455 0.098585640950937941662 2.0031719717176961204 -1.1263602139293900084 -0.1749133185804888635 -3.9242291034941554351 1.1004321283740468029 -1.1060507901634082373 7.5345894287501584685 6.0463926380699772878 0.45025725380897624328 1.7412193107190077068 0.49376054588168211135 0.49216086002962977641;2.8952886146704837067 0.57597273407950522195 -0.57131336595694537372 -2.5148029118815067307 1.3805349101846009496 1.6292179576980263533 3.8714967820206354077 -1.0853127222798637508 1.2133572172343323192 -7.324263112000054754 -5.915569256427057887 -1.502595965262594202 -2.1031695169036725979 -0.44544095694764379578 -1.1148709812983959022;0.97651910774759420608 -0.43734032316480930813 -0.090961513260175097528 -0.77180359590997216213 0.41731456566570440669 1.5259585041885155299 0.81527091334582058035 -0.043686812910216109296 0.94382248170106586294 -1.6231981797399110956 -1.1715433569633908473 -2.8175839356344622999 -1.5943686765110653969 -0.10798227096076229437 -0.16541088857973126891;-1.2688278831815225089 0.75075355891591999402 0.026450827487790283532 0.83319345528899568798 -0.37647561397498802149 -1.934545474165678236 -0.98009324149007603921 0.2476905631020160925 -1.529849658185637562 2.1752960841980226725 1.5238122725909670763 4.8287597703996842924 2.5949872541084526567 0.22886883273024868912 0.038995933590860912266];

% Layer 3
b3 = [1.0273213930124767135;-3.2441046655597673976;-1.598101702839893834];
LW3_2 = [-0.80155318467653191572 0.20929090232080274636 1.0116520566550637472 -2.4034548869083667277 -0.23282972922739103572 -0.11383343867780948422 5.0835552870860230001 3.5481997620048573161;-0.7253152142127738955 0.81920668750883662845 1.2867336132084046252 4.3995319226013380742 0.0043059906788909651371 -0.023610103858411782968 -3.2024458781587430423 -1.7538346275602028079;-0.39808634640834827945 0.36981764114312509761 0.66334680394733525066 1.107493481182868944 3.4363990054432109744 3.4247007828722924039 -0.67620701775526170785 -0.40875423513340847226];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [1.53609759285586;1.39457288619531;1.69075622529461];
y1_step1.xoffset = [-0.0925840202828198;0.38422497046037;0.00274753633745436];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    temp = removeconstantrows_apply(X{1,ts},x1_step1);
    Xp1 = mapminmax_apply(temp,x1_step2);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Remove Constants Input Processing Function
function y = removeconstantrows_apply(x,settings)
  y = x(settings.keep,:);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
