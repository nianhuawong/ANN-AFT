function [Y,Xf,Af] = net_cylinder_quad3(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 07-Jul-2020 17:11:23.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx8 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx4 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-10;-10;-10;-10;-10;-10;-10;-10];
x1_step1.gain = [0.1;0.1;0.1;0.1;0.1;0.1;0.1;0.1];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.0479053325427849508;2.630148828361774882;3.5324363367100999334;3.0918994269474144865;-2.2162593172893774174;-2.1920537519979732544;-2.8155469592389139599;3.4182623785394623539;-2.8121122513357192929;-0.0018571455817277763428;2.1420654914321546336;1.2933143287020452128;0.66042747508104415743;0.47581817951578220249;0.50139069586381501686;-0.52413893128595923088;0.11869880976016466967;-0.71321259089226130001;-0.015905179792558551966;-0.035877629505563050916;-0.0074664427695141253813;0.083380181778049997088;1.8852166762211324258;-2.1742528484286296475;-0.084090094923730512866;-0.26582897577593761484;-0.41159941633756180757;3.4941881932599985205;-2.6607601519977750471;0.31246743986715963537;3.5673261413323378299;0.69312793296426167267;-2.6975083822000449629;-0.01935851201280170894;1.753923842931029764;-1.628184586292539926;-0.84805968925286023818;2.1213411525399208379;3.8078895288339462688;2.2819727004234255929];
IW1_1 = [-0.27186300581641720253 -2.1072324169811547101 2.0850151085882728808 0.29411331664253620444 0.073187598322763822156 -0.086394500717204752993 1.0917966023423544275 0.084892165910655847938;-0.99190896028968178477 -1.8594509630754039176 -1.7920700849622235307 -0.19831533501328907354 -0.0090298474463949823104 -0.375602394697675257 1.1388322975525400071 0.14826948729162647833;-0.64395099440906844457 -2.456753430369813973 -0.37423911902981799038 -0.053527776981467066475 -0.082230490704723366302 2.1097782958538746634 -1.4999293631930104009 -0.31642758389125635876;-0.59784366616371575898 -2.9833766969852866247 1.2834536605273831888 0.086286861496477448852 -0.12110680894953694542 0.24129756124494031178 0.18077841487498663708 -0.24739977947904787103;-0.45963993185939328034 -0.21054184926799168753 1.2922510233638122568 0.79705702558283508807 0.49079160761083834297 1.4503749440306821228 1.2526013933707553782 0.014389125008154155308;-0.15669600787729859315 0.54130075369218677572 0.088659121809091814836 0.3291405038274390904 0.28538401162793658461 0.50740463669025370752 0.85484576906082354597 0.055635887204240647153;0.94737354864614697902 1.5535948284966756283 2.0696831614095745344 0.23608262960618980886 0.032279130066314977443 0.74161501801699625247 -1.5044308762950140412 -0.084725283645519608444;-0.75640449503934303888 -3.4344140287257252098 0.82547880527614581059 0.029479555784852163464 -0.12616764565057808634 1.370069927696698775 -0.78368860761397396431 -0.33913431393766452215;0.34465862567155491902 0.33945697914509359583 -1.119819124643601338 -0.52002460375270975756 -0.40153878214069688157 -0.6924081727099110628 -1.3225121367422849605 -0.054069508380697822725;-0.76114929675541531662 -7.3727375931084200289 7.7160610729085243875 0.47537784275531358436 0.11102332351782039088 -4.3569942793467015818 3.8588260226128960895 0.33672233504859844233;-1.0142950305277962375 -1.9167401891602680042 -1.6119592893765168906 -0.17241145337984881136 1.046571207493176333e-05 -0.11007171878361081407 0.85572366906896701888 0.19750243794818650445;-0.43758321125095417381 -3.4379374039645043126 2.572227686442638106 0.2263060338151749451 0.12250266569733275768 1.2744429555337877247 -0.94540606557554485168 -0.067739368816206110835;0.15521627919561570286 0.3025630939529496688 0.31672436503500389637 0.099148149629150320039 0.025517430506387949601 1.4713768065832311116 -1.4750922400030865855 -0.02059799146975488035;-0.11495457732651756522 1.2041134701271545282 -2.7494819414967501814 -0.32341843622293814375 -0.07624119456516680049 -1.0883567180323860946 1.340364000069847128 -0.066820386263953299166;0.23849655154839269344 -2.5638491437239827597 1.1760354599611866355 -0.55309089197864724774 -0.70157275066885793624 -1.0145427010683902846 -2.0367744964934941798 0.0014208585501330514133;0.1007141656361740939 -1.3487777102749267666 2.7521638556340257686 0.30668937150104069733 0.051999485887419705232 1.0488247271082227208 -1.319990476874131291 0.050001524564449430221;0.27954311588500896368 0.68441034570698555672 -0.64705633314310151416 -0.23783832712475716509 -0.20800799500395819597 -0.87022118867368669637 -0.37951357468207547186 0.022529007659362949856;0.20904449261043023256 0.62919997952301598421 0.53941138752612438623 0.15639124102561316465 0.030859904275531951923 -0.26105122276006526016 0.14704143380886586234 0.1172013918671920979;0.50332397709375453765 2.2654378444457128339 -1.5266263352469409131 0.0061835498127305555879 -0.18361608357060416052 -0.12850441136800472286 -1.5344554451855099142 -0.3707074589184119473;-0.056011324121657199426 -3.5492348836133866818 3.2159648571970382847 0.38327681645945366196 0.56513361215257729153 7.6596505100109197883 -7.8643350615530831504 -0.39049727334596434636;-0.57901757550245003259 -5.1214430468921881001 5.3478620022659972832 0.39962413184774370212 0.17261553107709712296 -1.9310838331522910405 1.5669661566476633663 0.14952559203971171886;0.54695610073301625942 5.3666548721683469125 -4.172227153347109585 -0.32038471257803968761 -0.25644095477911493797 -2.4733879439411854406 2.0231636732154347769 0.14267027458266595685;-0.68406748242989534603 -1.1099068939572203085 2.4680844488028488293 1.1515694933206064299 0.61285019784414895838 2.4977619862877733503 0.99491821387551893086 0.13448323361532776854;1.3195988973693191237 2.7921369960511959185 1.4965250816697208691 0.14066021384172025521 -0.0084947814298383800269 -0.11703705823792773244 -0.78774120960749938192 -0.29352423612640776707;-0.10912147365449477443 -1.4675666429142368852 1.4596536772318202679 0.17099806769563705156 0.11561033948339259625 0.73410492900020729579 -0.92682831193168724315 -0.01974624880677178923;-0.57625318488371846115 0.08519040614998703298 -1.7036937279841088966 -0.52570348447940240533 0.043485470197938795589 0.42280673677129942956 2.5953675356342462699 0.54002071665953255142;-0.23730299110444724731 1.8162831470617242235 -0.64292264531744047762 0.54080866167079999496 0.5760881760349071401 0.90401153829285296748 1.7592832218010321377 0.019812980661733758936;-0.19819028203408065036 0.4259354464194355927 -0.50341345388898728341 0.52018978562978956948 0.18951327361291120388 -0.83376921928977154597 3.3789591230920161813 0.16396393665435740616;1.0577886087614540855 1.9634224976514418337 -3.8461590022563965086 -1.6499407397739664916 -0.8211540751769529356 -4.1758986805231037565 -0.54846877725415676963 -0.20009777916852392043;-0.26832679320542573986 -0.68566680799773738197 1.3902013958910595104 0.66879405314075557332 0.41258658343900356247 2.0779898041616107207 -0.18075084772021404733 0.04188097567447680164;-2.3068303472990279168 -2.4640834095530870229 -2.1960658208771435262 -1.1549635893879626192 2.5308394137595735529 3.9961122106091577777 1.2330627141872809727 0.9126941357332701843;0.22570407127279804027 0.36195679500694666331 0.41065835212240753282 0.188327481244610212 0.05181765678033230238 0.49263204965042439731 -0.38592762365482813358 0.076054229215442276102;0.32888739336987438122 -0.86121979417731275852 -0.21481355901367879535 -0.75326763348793446262 -0.39610917865148642658 -0.93013044019836066401 -2.3737045830424396975 -0.096782963150125966845;-0.37458690113276138511 -4.1228265272391926288 4.1725767998586187346 0.35068333683676550239 0.19788077057001760006 0.32520226380903544117 -0.59428070161039758812 0.033657346663699461153;-0.32532501968790222824 -1.9783414718821072942 1.9539943190697670605 0.3580662059409093767 0.13855006588402554724 0.15000846557900471279 1.2014875185123181645 0.061870808281947742291;-0.54221940891498843218 -4.1006257002035058079 3.1162239854556776919 0.26751434124601569664 0.24595948753125093655 1.7854252183316230429 -1.2828250610945493015 -0.080983748651905954064;0.17289337179963573665 0.17578159480769997569 0.76159554895839898236 0.13743839691534853742 0.028303702769543966772 0.8957237164708053978 -1.006656849519991459 0.024357008272021529738;0.14994258934464566035 -1.3437249453607198468 1.6357594593899802415 0.094313337542007144587 0.024270073516761907217 -0.19226056387540771397 -1.6256195236909463109 0.10682291200588207858;-0.181528039844540523 0.1937392913713282816 -0.33202847570247223663 0.44995880893144157842 0.10978591609358481773 -1.2618381670506824133 3.6089302590161613793 0.20236233372940079511;0.65233411408743502413 2.1003786448740329185 -2.0427867183726120537 -0.67117232112775182529 -0.62127987649370763901 -2.3674650135906989412 -0.16391985984750997996 0.11100420836643244693];

% Layer 2
b2 = [0.46640902011929230575;-0.14641227047541144346;-0.33658864762758056166;-0.43594270854467170873];
LW2_1 = [1.7323310292827782675 -1.0777800029890636235 -0.025278489905842225355 -0.52196824844055178527 0.055174860882684612085 0.14173253168706795302 -0.63481300444692878582 0.34734014408683627773 -0.050069072392427221851 -0.61959721966367564683 0.82780024837881971411 -0.58570525248148397335 1.0437148450394562182 0.31445348841293502273 0.22025619701147208795 0.4139168907313586776 0.14309078618999943044 -0.59959763305052693472 0.034355897658855306942 0.32966587677374437071 1.6838392765429994746 0.19066550804089699156 0.14022030020097653313 0.26934839632302315371 -2.361174888483616563 0.019768151455549987788 0.34676532664322767818 0.94456415031618967681 0.073768426021752916966 -0.0034746596951771660002 0.0052873560207139479183 -0.4345150598625924232 -0.061968989050092494753 -0.12981812939384032579 -0.81015558378780638815 -0.32243496186447123675 1.0907254701677817632 0.008538548826667879954 -2.1139386973056981667 0.027319741348319409591;-1.9694333853448922067 0.55090941676400040361 0.41550188260962811482 0.26381464468144977253 -0.055646213212183423535 -0.19881798516385473796 0.219010999666858025 -0.42537609380171415019 0.14764007483123653408 -0.82612819923060765159 -0.52498804826982914395 -0.059048352131138841237 1.2763227625078323868 -0.74881545554438566636 -0.36469402458230687492 -0.99154352067483453315 -0.20130183308160579103 -0.50428551067786342443 -0.012982424279379824184 0.30589705907540321039 2.6500234290895985367 0.0072105048879375025633 -0.099322907371748300753 -0.1996992720259509746 -1.8047515575064760895 -0.010262241293914118809 -0.52446569957938105055 -0.70813257573780497012 -0.037931735117944294366 -0.010812529710081760295 -0.0039072912330215606169 0.00064992091533518482963 0.075073159852692861183 -1.4498121699906394433 1.0116141614020748296 -0.044669787104637370678 1.7467580221990512968 -0.084782645249792149 1.5412978832153463316 -0.026259460355139277454;-0.35686683631367749348 0.57429189453177709179 -0.040145169190663854142 0.19169157460153232742 0.094191865054821952152 0.45259353079880887405 0.33778658393071669952 -0.033282477663018436576 -0.3433932660758013955 0.68984990053651085162 -0.41945296935806208882 0.14548175358963544301 -0.23962739413106431963 -0.0987911110979806939 0.62028476619389583124 -0.12805885374921427422 0.0092306800138961999508 0.15075606588894743809 0.038487698275561747774 0.11114531407687236464 -2.197169671458738538 -0.048287577258679444114 0.35400372212087005686 -0.1370014811042270797 -3.4891828740791472896 0.016490463411007016958 0.94490866606573553632 -0.19277895768471173255 0.17378863077332598608 -0.12026996640134199335 0.0014019552897507662169 0.16317565893587579473 -0.057694775771757800253 2.8668089168207666617 -0.055234642494057697992 0.067859886466057783849 -0.24735292307340348006 -0.063413994609606769148 0.58418413099408827982 0.054864206237089492568;-0.22587344123423630515 -0.50833172670006454563 0.35541027257387924898 1.4145999043748098689 0.085482329638217932621 0.2698109191808512608 -0.29494843065035014629 -0.78583485075919412566 -0.29113240427184744474 0.81394539310860991588 0.37902273997039825915 -0.20873329306165636088 -0.3563421893818139452 0.43533968878170248296 0.39496829450142489915 0.47034843220574190648 -0.16632469521814624569 0.27604575498359640306 0.039388401227145070083 0.089335366707159385991 -2.7577204974582043562 0.10809160778188323104 0.16438621550435053575 0.12657546719871237695 -3.548190680700636257 0.012473994583427430033 0.60882639711222830137 0.34533943965286639788 0.058192102387508673478 0.01271098942108894736 0.0037821712181621198502 -0.041876723904744825311 -0.078577775272540562046 3.5901823508011538877 0.046462935698591327494 -0.22219696396007604378 -0.45358989030747437488 -0.021373611429345715923 -0.8739429597939030181 -0.063458155097158616686];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [0.1;0.1;0.1;0.1];
y1_step1.xoffset = [-10;-10;-10;-10];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
    X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
    Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
x = bsxfun(@minus,y,settings.ymin);
x = bsxfun(@rdivide,x,settings.gain);
x = bsxfun(@plus,x,settings.xoffset);
end
