function [Y,Xf,Af] = net_cylinder_quad(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 11-Jul-2020 15:43:45.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx8 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx5 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [-10;-10;-10;-10;-10;-10;-10;-10];
x1_step1_gain = [0.1;0.1;0.1;0.1;0.1;0.1;0.1;0.1];
x1_step1_ymin = -1;

% Layer 1
b1 = [-11.454941932037315;0.90408034893471412;2.4550449980145603;5.5810175696093678;3.7968862256583846;-1.9372371020127195;2.1530585769330641;2.844845407210367;-0.23189885036282556;0.84826083820890885;-1.9853700088303394;-2.7679081049989986;-2.2182040395504279;1.1264200229159664;-2.7412439415674448;-0.014107505451839246;-1.9852667051512602;0.30293672949179634;2.0300693122611482;-0.43401652756301407;-0.30533249481807151;0.050382602569618733;-0.0033587828111960841;0.36633763600224228;-1.4435776018924129;0.0068296418198484947;-1.5632365062100908;-0.093003174791890728;2.5036613177478775;0.97082726726058532;-0.84570812364270953;-2.7990943471305934;1.0033315778048444;0.38233182990013159;-0.6961939131296162;-1.8791428778377159;2.2758931059780005;2.6516369718825246;-2.7727417093378328;3.1405329681044907];
IW1_1 = [-0.25395336240851013 -5.8695693244072222 -4.1237421586736938 0.63347443676607584 -1.1134296136843218 -2.7640875771836595 2.5702273941477545 0.65750367478645688;0.44526042462394488 7.0319969192554499 -7.1516458010752357 -0.31195562139949906 0.10596227538870158 5.8416650440929114 -5.5078926574073579 -0.39736847261041897;-0.28857703331023771 -3.4443997222573071 2.3674628997780802 0.25738635964700318 0.1756432088647083 1.6893443998889461 -1.4527081664578567 0.0025667928578939955;-2.2259976131210473 -4.8156315925688835 -1.0177439187301376 -1.3036586798978274 -2.49088818884566 -5.4736312089424413 0.97257711949842984 0.84599713340518135;-4.9025182958289388 -10.011856701044175 4.9702644794995452 2.6462601689454797 0.39142597692729519 0.26657751309480965 3.353367900762164 0.60173255378704216;-0.035629504828979502 -0.32577865487169905 -0.6210145919625768 -0.13166160130032556 0.87104403939936492 0.95456757564764505 3.2723970058049057 0.24283456895419689;0.065121600238875338 0.46697641933968709 0.36415686194535002 0.38903898889485405 -1.1604496205775348 -4.4588177243223663 -0.19571538992398993 -0.14067512020196557;-0.78907243604224697 1.8494655480684472 2.3984913913172412 1.0102035773583851 -0.6627701075885174 -1.1611948613887224 0.25219189773288231 -0.490074576812212;-0.080602560174339644 -1.2749135422997124 1.3127823557674294 0.079964407011058003 0.047969390871514549 -0.017333522051623459 0.2827788510798373 0.003032171791359309;-2.8762585525691251 -3.2772301883105386 2.4787216974790494 1.0073737469973052 0.24937184136313981 1.7935176511630659 2.1869308945466788 1.6002584532597945;0.26771861422811505 3.7049630838489023 -4.2225940491834368 -0.31875588511254155 -0.12522529120164547 -0.44825156705716906 -1.018083109612443 0.14125870880891905;0.71155079944633393 -0.55412132845680528 -3.5223450064743904 -0.93107358091441506 0.47015445671482126 -0.33960614791248595 1.1925224391871181 0.56495951022715973;0.48052412243003051 8.0793715521795022 -9.1950159453612201 -0.70702530912542139 -0.11603504524948266 -1.6957976086906268 -1.8460376061579578 0.14039436111775344;-1.401102628823985 -5.6918747752952701 0.50344257626577149 0.37243028506126274 -1.3667392484276548 -1.8263749433584286 2.2640785083460759 0.93223079978298662;0.55946159871743395 2.8483741747956448 -5.9352394263212052 -1.0916647864128455 1.2786171127289443 4.5379118337483311 -2.2266676748894612 -0.70356610645100326;-0.033801193398803102 0.95524521552233554 -0.78836916288780023 -0.14633293962510893 -0.15456437317246924 -4.9045819051118933 4.8975603838576358 0.16188697720767461;0.46181141610731125 7.1245263824000906 -8.1805870946819272 -0.62465810113645093 -0.13164700476846239 -1.4774764161929939 -1.654514921341764 0.19513394032573975;0.22189575319222749 1.5689147091983349 -1.6200339310430647 -0.21592538759128799 -0.12835030397836442 -0.84958769746537377 1.561622588353645 0.061539542490407953;0.066452509023627468 0.51797109268779817 0.35544590974831636 0.24925111669328323 -0.9978864500111243 -2.5567749742427113 -1.8638859120582603 -0.17899351642099479;-0.33810959504531196 -0.092622357559953183 -0.68299033371817786 0.20478350925776387 0.23935195664526815 1.1379310267288938 -3.7931032337721904 -0.30908579387673762;-0.16415712388305442 -4.7669189836362786 5.6523638997602257 0.91018056237911982 0.017557177294627118 -6.6705923952513455 6.3277187713775902 1.2397148380822611;0.050629081527727986 0.45491022143183635 -0.61294098902468364 -0.071664333640221844 -0.065323206479802318 0.016152893625915626 -0.11029790217532578 -0.016888643720462188;-0.067326244022221565 0.28430798071887547 -2.2985962478437436 2.0877009432902325 0.09780423938221515 1.633871315154368 -5.28411127270292 3.5482050114439252;0.20346526416233626 0.019924862379859819 0.86550460369000781 -0.040077470027470384 -0.20302257967708986 -0.71325330721820113 3.2632155680875097 0.25141813534248314;-0.4802670062395672 -2.1329330515442435 -5.2438708138233627 -1.8295293078776182 -2.0142726937390054 -4.5012517067891826 0.31403026789936811 1.1973866156080555;0.029936176379112459 1.1788014216595024 -1.7394559224886914 0.52875186121060647 -0.10954684863054799 -1.3412430810738605 0.29027248056848043 1.1702253114990677;-3.2092355152057932 -5.1224135173938903 -1.4422403904062409 -0.40319365564626408 0.86645489525954567 2.1671753216584904 5.1658909073934351 1.6765581981349513;0.32477700413639665 16.791884262286832 -16.892276827493724 -0.20625732504912758 -0.75050450593737683 -7.6372177922616968 8.7773746774916663 -0.35348224073813139;-0.39545624052884804 -4.5972738604980803 3.1996247554735171 0.36067718399351245 0.23172043123457239 2.2356961830030593 -1.8909932817609723 0.028964411022532891;-0.40031877915983505 -11.113869856090275 10.657737168598114 0.84243235776740866 0.89166538403450479 15.210319976358988 -15.618511474468256 -0.5547988226291809;-0.41448276105329662 -6.5570111325549867 6.6135587239778344 0.30191697113191329 -0.091560133652936193 -5.0961857131491817 4.7802662223078807 0.35147565305804324;0.22291282092360803 -1.5612817682055498 -0.53688360233815846 0.098662012369281973 1.4355152503821764 3.4444760965058072 4.7746177803894838 0.94913550132270708;-0.20418208901997015 -4.5054282310280476 4.1009275555232225 0.26220390023399048 0.076585207934338206 0.57586316234526247 -0.46994846669116752 0.044693414351895035;0.069062338788045283 1.4810217049621279 -1.3186944726661982 -0.071409407959529103 -0.030576286658781961 -0.23438587136029593 0.19668316836543501 -0.0034454219107122961;0.33676705074659685 5.4745312247386302 -5.6628424285471208 -0.23389778621788235 0.095903878129094219 5.0678200613672271 -4.8088114777125899 -0.34232545758843402;-0.58657831756556766 -1.9839609391827315 -2.8465460295828415 -2.2045641912233136 -0.14643466651003861 -3.7270673968141845 -4.9631739869169342 -2.1278678427538016;-0.31242769825434347 -4.1518292755507922 6.5693549990111926 0.69635633215049209 -0.26031201065814374 1.8904505065995909 -3.6500547116393314 -0.052599918253075396;-0.37943407625621306 -4.87991514155574 5.659464733321137 0.44148319049991641 0.19599863010546012 0.70822357812626335 1.296303254148619 -0.21505396093982729;0.46329654955995336 -3.9006764114592283 -0.011269209214538067 -0.26659678188395658 -0.21671268031588567 10.041075786347918 -10.650951143819237 0.065264858843584905;-0.059197269260769771 0.64820267171300039 -2.4539778488203967 0.275289449392495 -0.0140758595397422 -2.4281920226784419 2.0256621390139049 0.29447934759910466];

% Layer 2
b2 = [0.056224970464764532;0.28031095690116326;1.560285200964286;0.95526709508531982;2.6529705038627007];
LW2_1 = [0.1758978518346693 -1.1848116696130915 -3.5484589678904599 0.00043648080424273848 0.0028494173985246338 0.40686911320995967 -0.36930709851877924 -0.065577274445267023 2.3568590336646307 -0.0012259070758013479 -1.0473441715242167 -0.067093127760533111 -0.1967116488166023 0.00099546831756285189 -0.014004172679122379 -1.0359644572137681 0.28234674909270291 -0.052495585882730088 0.77111507730389328 -0.05302875117025202 -0.0032349983276537503 1.2575589506238114 0.22170901411606639 -0.048655917481114717 0.00028492343613423086 -0.76571626200399578 -0.0010820962648307902 -0.027967972806278944 1.3551851097916505 -0.0098338296716369671 -0.71413545828570801 -0.0048547773922732376 -0.51020010408362615 6.6553651391077286 -0.78424498984949831 0.00076068206643574432 -0.0059072504611699817 -0.62440574263523507 0.011268611908355508 0.29687328487327086;0.10138785968385168 -1.0093141971571689 -2.0375649475554813 -8.1820149115522514e-05 0.0056139927701593676 -0.34576342689313566 0.24590567420970325 -0.10753998239547788 -1.1804523786685788 0.00089230529326010167 1.9019022536308519 -0.12070980745238807 0.37224118049180038 0.00015873017753340933 -0.020619928300716572 -1.5744185760225886 -0.54747802921788413 0.15042112182851264 -0.58555093556214366 0.11561109876600702 -0.016047955127944075 -3.1301945153290593 -0.42173739038144287 0.12629291862315442 0.0018941445644587384 1.2079536042354651 0.0019646740667829616 -0.020566503491579971 0.77585419749170004 -0.013901119175543987 -0.55698998392457344 0.0019393704609423316 -0.13859782642346527 3.0049502039948486 -0.71462144884455958 0.0017681554742439945 -0.039723845785100277 1.2704865385413129 0.015164385131755082 0.22912571922034486;0.099485810352398382 2.3992843086147699 -0.054664110478708457 0.00090980309523569568 0.0041248638345102086 -0.29212623980041474 0.18476726521563655 -0.10536140138387021 -0.14312416850659546 -0.0025313785157647711 2.4113148265242663 -0.11518602881726496 0.46515132538297382 0.00052866895215733761 -0.021817487537516184 -0.42557943151534444 -0.69786484746041288 0.25940757632136274 -0.46915505572955674 0.18395714988814535 -0.018440121913148942 -3.9259215327403081 -0.97210818474598204 0.2051943664435941 0.0020074695102119625 3.0988466779211334 0.0027061939328268877 -0.057167333631659885 0.03551214335561368 -0.016275179819814564 2.2052344225313982 0.0010384598128621617 0.64953090772197741 -3.2705170124140728 0.7487522862314141 0.00308467420319885 -0.036023052457619914 1.6545402773525966 0.013979604238763096 0.044166302502111142;-0.1289278452851163 1.627774711157868 2.5105329951038815 0.00086765311969695799 -0.0012073157618705695 -0.3634262350653828 0.33270909748309041 0.043841278849980847 -1.8835532012687888 0.00025805071734509116 2.4418934324122921 0.047560624340324029 0.39023439791559444 -0.0023561789973012962 0.017874043927970838 -0.78912515247183657 -0.6079787417148016 0.04728119515744425 -0.69496039577048296 0.091054463474550526 -0.016477900253632227 -6.3416125519383666 -1.5917633675470091 0.11201732378667431 9.3295123235560978e-05 5.0444095901319503 0.00021934974814500434 -0.050649191597301385 -0.92297618026206274 -0.011780111228087871 1.2298938124332737 0.0022305042537446949 0.56860725292498859 -5.999083068875894 0.8127064717710708 0.0014578883514504001 0.024054542151747561 1.6633113693665729 -0.0050844092923700923 -0.40736776571766564;-2.0103716985727087 1.1352631977277321 -0.47071967068767778 0.19438849439429315 0.10895409093721679 -1.0959055243010174 0.53211451178134739 -1.322135588512092 -0.79638369572418088 -0.14750507161896581 -0.51162290904982921 -1.6686231173120558 -1.9674932088884614 -0.2434001068089249 -0.18276767129453991 -1.7417330154410695 2.2806942306146234 1.4117505473523448 -1.1182523681091203 1.4883406293197758 0.024748993266826919 -1.5676690995071314 1.3675768134731314 1.6403306178268438 0.19751248122827342 -4.5075919086141534 0.18411299653015398 0.044570975145502699 0.31852153416739887 -1.3373609934258706 4.8972012403007943 0.34803716952992308 -0.87783448145295795 1.4283058490797376 1.7061043851205242 0.19597682054218804 -0.6437325349701154 -0.63871350963331253 0.026637069280860501 -0.22925823997680092];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = [0.1;0.1;0.1;0.1;3.12341402393571];
y1_step1_xoffset = [-10;-10;-10;-10;0.0942940629850542];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
