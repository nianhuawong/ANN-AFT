function [Y,Xf,Af] = net_naca0012_20211227(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 27-Dec-2021 15:05:25.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx8 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx5 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_remove = [2 3 6 7];
x1_step1_keep = [1 4 5 8];
x1_step2_xoffset = [-2.21657909544629;-0.43045336849298;-2.19786066020614;-2.20526131813792];
x1_step2_gain = [0.547697936064627;0.548880042420084;0.409383428387717;0.410196262516521];
x1_step2_ymin = -1;

% Layer 1
b1 = [-4.3574785588425167;-3.326829199047455;3.5535587034456757;1.4324204408943766;-0.28990358914852343;3.8213999348553145;1.9840484706418315;0.019292271825388452;0.4044074710447092;0.76118970011819798;0.32097220158374984;-2.216804790252028;-0.41359155812198783;0.12647453620462376;0.50630411295210775;-4.3786004950078476;4.8155613006358768;0.97857894805659096;-0.91092522334653769;2.3144224837125931];
IW1_1 = [1.9557098774058237 0.22339809731031179 -5.5789964518362805 0.89694106914313987;1.046357626907837 0.88891832642888924 -3.3682518631924019 3.0083491360835155;-2.6778703574781049 -0.6726423770168336 -4.3954144380322422 1.3057056428789748;-0.50866905265463258 -1.7925738204282966 0.20779989887130382 -2.508776235274337;0.074582651109789053 0.3689212066602392 0.23992204795499963 -1.1925012818621625;0.32692826075365222 3.679370886104592 -0.045196688511066972 3.366765223149276;-4.792388403847256 -0.1607682684811568 -0.81646209819482618 0.2462951763597695;-1.3370786832171564 -0.089117716249978052 -1.4463943444452432 -0.33318723204302653;4.7967730594660551 -0.036254845879784406 -4.551243795076708 -0.075098917327549489;-0.74934986247577962 -0.17502706018197511 -3.6620361305812916 0.15203656907264423;-1.8899497595109487 -0.47738263697747085 2.3041824147497878 1.1791138595877761;4.9130665132231917 0.16984626724776006 0.43875149350268899 -0.219041081156751;-0.041370500644562352 0.067839261347362179 -0.088598593225141076 1.7550351867856715;0.10640429175321554 0.21872409990369929 0.076863333310542348 -1.4024289043519655;4.8950111751720673 -0.036403863714011227 -4.2699742616759728 -0.085286655715018381;-0.22190711396133239 -7.7210822641220433 -0.35280898233748176 7.8921694800554052;0.22533947379963437 8.1395202604060373 0.38562423110626859 -8.98526860059882;1.5416268277814451 0.30045352607270298 1.8490070749424561 -0.84473519492569948;0.50184349387168614 0.1774509581706343 4.0353265935781515 -0.14739495268197708;0.17971659037941007 4.0311140281928202 0.091709558847896999 0.13120141572968946];

% Layer 2
b2 = [-0.43775919384134193;-0.27375331981624706;-1.6097676103799679;0.43077786396663981;0.17898974641332577];
LW2_1 = [-0.19950575106003657 0.11917876001080129 0.047840421572176203 0.07967323730860254 -1.9867784810571925 -0.19845066325415037 0.90439084524017987 0.1124850358990372 -0.48914384197058647 -0.3891832283633393 -0.077305909142144025 1.1091948342845848 0.2722478804690816 2.0084825548468528 0.3747091251180632 1.1556841366500297 1.0265257327427795 -0.24411142500051219 -0.043159399001436331 0.43909273481228062;-0.56248693557918295 0.68578677831824131 -0.41985737469882467 1.0072614708949963 -4.9316580512999773 0.59716716518914381 -0.70907919576875955 0.89061261406247316 -0.20332157991646554 0.99922198874203849 0.1587131603796858 -0.47254723863006415 8.7810341662328408 12.685694300008997 0.078749423629416837 1.4478890504933104 1.2316061741070774 0.40916718315958461 1.4951484068816243 -0.58654868992772047;-0.21704116566071532 0.40265754008985638 0.73113642881611685 0.6798147019058477 -1.206374870956693 0.05004845654219154 4.4458701608220546 -1.8756091548879192 -1.8449024800841229 6.5876624044568315 0.47513291831346804 3.868473884624398 2.3987115309395084 4.1848671195103204 2.0318159012862225 -9.025010318608242 -7.9784590080652489 -0.563534262717034 5.4514556893701309 0.017090783448342101;0.26229771177824751 -0.19700092621334073 -1.0147260207374764 -0.19003744816419108 -0.37117171207633165 0.076093537381662538 -4.248397794790252 1.4811078460259528 2.9681977271045152 -6.8639232137286141 -0.048088453559569727 -3.8899540260613703 0.52677524062033942 0.24453689629010239 -2.9649491783100759 -1.0370337011785711 -1.0564987477146448 0.58835373363086974 -6.0294659543765539 -0.13625095872339935;-0.045256546117532104 -0.20565661387651379 0.28358959192135375 -0.4897772537416511 1.5775465830329247 -0.12614199392384912 -0.19747236603182436 0.39450130886195806 -1.1232952470203506 0.27626080927180907 -0.42704446475389068 0.021480141436946341 -2.925486771559711 -4.4294040158001859 0.93313327702381066 10.06204401978704 9.0349577557801108 -0.024819470913838522 0.57801026500644714 0.11916017527505597];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = [1.0720859093807;1.22033434513332;2;2;2];
y1_step1_xoffset = [-0.43045336849298;0.348463990990513;0;0;0];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    temp = removeconstantrows_apply(X{1,ts},x1_step1_keep,x1_step1_remove);
    Xp1 = mapminmax_apply(temp,x1_step2_gain,x1_step2_xoffset,x1_step2_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Remove Constants Input Processing Function
function y = removeconstantrows_apply(x,settings_keep,settings_remove)
if isempty(settings_remove)
    y = x;
else
    y = x(settings_keep,:);
end
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
