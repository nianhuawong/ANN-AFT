function [Y,Xf,Af] = myNeuralNetworkFunction_cy4(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 04-Jul-2020 17:34:45.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx8 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx2 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [-10;-10;-10;-10;-10;-10;-10;-10];
x1_step1_gain = [0.1;0.1;0.1;0.1;0.1;0.1;0.1;0.1];
x1_step1_ymin = -1;

% Layer 1
b1 = [0.60908093346111991;0.068513002840319803;2.9801232064602741;-1.8477787075366261;0.86634963851123448;-2.4763899250813668;2.7447757009956333;0.027899790296027578;0.06552007233544499;0.50427181475576888;-0.071405333019262926;-0.036304892284795984;0.289248169327744;0.1560046175777022;0.75449427692893201;0.33024280961051322;0.41153143858806784;1.4734246181101696;-4.0557090627897621;-3.0036877619156002];
IW1_1 = [0.013492267044081888 0.023324464047276207 -0.89174180881436238 -0.041702512800711695 -0.069998505892520727 -1.0744437039001731 0.52968797392896372 0.058361862347774775;-0.017961128244396281 -0.10641992165069962 0.67575649423575035 0.047325953786054829 0.0084067776953815967 0.06294048292306946 0.16481401515235516 0.0068435666487578093;-0.27120863571518977 -3.3006764608600432 0.70091547270940191 0.22105059741071842 -0.33762521686871116 -3.0637997361888125 4.2313181590587998 0.39534587947254846;-0.10580894681260791 -0.67184044947129917 -1.2529114954969969 0.10943412297740913 -0.33047724658657207 -3.653461502431322 5.635533810537293 0.10402150719013965;0.045207479757207965 1.4460779744935022 -1.5444519826527294 -0.1207337277761055 0.064631469421669266 0.34265754878139681 -2.0855960564832454 0.018425178440283744;1.0350710560996743 4.056290672720821 1.5449371648836026 0.75511205729005215 -0.74907190012865643 -0.61108913647693786 1.9571438911713042 0.48424246058400333;-0.25106531582661562 -3.0281163204412085 0.60850335988416338 0.21422164843300251 -0.30113977286673366 -2.7864157519101105 3.8659370710039411 0.3643078240888441;0.13895407342737306 1.2055082346246797 -1.5539874798971425 0.098703830445313348 0.20360686501934294 5.4788788868406337 -5.3816455169814086 -0.20829770773558909;0.20536662452443719 3.5762962527923232 -3.5443990581837608 -0.26457967365460577 -0.23049152577863458 -2.7398759467796698 3.146365630218396 0.091233924362209395;0.089063409726409193 0.55463245749972212 -3.9494762456449077 0.093355485471915953 0.30751641919602057 3.6149886070458339 -1.7621134067000666 0.5558943283782749;-0.15396213558586269 -2.6407043321598853 2.6552243725075986 0.19895985706762989 0.16749396984591808 1.9185256796859003 -2.2706334490980509 -0.094516009351960889;-0.47868925085267622 -8.0606049479843129 8.1532757434024461 0.40376643162888659 0.12717194620707664 -2.7034054043816114 2.2582954426669599 0.2052640931828725;0.18708981031238389 2.7334015496667883 -0.27259325082052166 -0.033415890804364606 -0.10131107624123367 0.18018245714141778 1.4116024769729019 0.0099617582211292688;0.58480141234166771 6.8150658284408943 -5.0101059902851137 -0.88350481537849401 -0.36859221521594226 -1.0712657660525062 -1.2034948514075352 -0.2438747378095435;0.19387895271088113 0.90048543798261171 -0.1734472632828073 0.16593638318565904 0.2349379611597805 3.1396630139099777 0.81901043618801339 -0.25172395662544478;0.027810972154722318 0.50544101448415635 1.5949231739212604 0.14946366847542383 -0.050039234312484589 0.40005515857752771 0.57926985969770095 0.032981480374632256;0.022268521297944991 0.2782316030749778 -0.13384905465214775 -0.03108951802947409 -0.013932009916916845 -0.26874855478032195 -0.039180036957587656 -0.0069819231233143901;-0.016197787984589464 -0.50243241453176157 1.3011561762124506 0.079122328518628438 0.048333722780182102 1.148175558285687 0.032772477266879624 -0.03658756758108693;0.33640398754673956 2.6697804748964415 -9.5145767757257715 -0.41302949062541877 -0.29856668112184748 -1.2298392256002526 -0.509572409101682 -0.044280168179807254;-0.18356587802699567 0.32177131325062802 1.8526386099820302 0.52822328388388129 0.5561769360883243 6.5598422521610473 -3.1495244005989944 -0.37213689502107899];

% Layer 2
b2 = [-0.66190779517148735;0.43391392541469764];
LW2_1 = [0.38216501582863532 2.1252565602658247 1.3416350924761953 -0.06671942811686167 -0.092239378496605462 -0.018736689042853121 -1.4579317537899439 0.20504887378300157 -0.5235911732752454 -0.026648687865191787 -0.6333597807870549 -0.023966175761231071 0.097810562258310293 0.0063335861308057191 0.014607125511075026 -0.23852454917512883 1.3609609827485627 0.012444014751823124 0.037273177013877418 0.069196022955868158;-0.80039094354205487 -1.0170152192695472 -0.38982818456945523 -0.041557528002872143 -0.17651627904151912 -0.0035276886500496805 0.47960122372430208 -0.048559315085201595 -0.86557734175965995 0.019591957838335155 -1.218805390781899 0.14011032612491026 0.10007043799666679 0.040052110150752197 0.036614641647207444 -0.020743154656294914 -1.4750156297853794 0.56465699849847961 -0.039793532166601267 -0.0092886074029766442];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = [0.1;0.1];
y1_step1_xoffset = [-10;-10];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
