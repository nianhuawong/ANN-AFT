function [Y,Xf,Af] = myNeuralNetworkFunction_cy5(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 04-Jul-2020 22:28:59.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx8 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx2 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [-10;-10;-10;-10;-10;-10;-10;-10];
x1_step1_gain = [0.1;0.1;0.1;0.1;0.1;0.1;0.1;0.1];
x1_step1_ymin = -1;

% Layer 1
b1 = [-3.2805013795003304;-3.3801076230807356;0.51478851735131959;1.2585570725238351;2.0879931839200854;2.1494225870434365;0.38716998103938954;0.48962153589261048;-3.3442261580735693;-2.8304005211498318;0.023427306590013651;-0.77036977847317589;-1.4556407135671408;0.010486162249281925;-0.097928696261835299;3.4311018832424924;-0.00064635579762986942;0.045514636893024887;-3.5384064545845697;-0.23927917540656582;0.45481525866072797;0.060226265397126534;-0.35339020822636735;-0.30480661604972847;0.030584338225237387;-1.2339931542408302;3.8216648529557755;-0.14296601393007405;0.90128698255315709;-4.7926640263725044;-1.2834390686803245;-2.403500904630083;-3.7959953153171848;-4.6861996706554505;2.4826153234388877;2.8520635790595366;-4.5641553222635016;-4.1775178654948508;-3.8079625086453781;-1.0382048130658317];
IW1_1 = [-0.035965582249715529 -0.68503658050641214 0.89293970508802378 -0.051289974462169992 0.042974271561195772 -2.4567426823359466 -0.97917088613422509 -0.0096095881349781646;-0.13137626195333066 -1.6500970972244553 0.14840396665598693 0.0066759210805071717 -0.11131999608354497 -4.013538904757957 0.83777100502158686 0.25887072266179528;-0.019265959304965299 -0.36182769584221797 -0.1891330551868694 -0.024496594301080168 -0.042499171834462238 -0.98243310131449069 0.9386566485930854 0.073517718723319483;-0.046570480001087412 -1.4006785235683632 1.2332314817279058 0.060243580821365522 -0.020443389682877313 0.10219699997963269 0.9740313746135163 0.016145059665543252;0.13462996688170617 3.3241393666773544 -2.3299352896803813 -0.017279007906045848 0.031357050749766101 -0.20318729758643206 -1.0879837790579736 -0.15625671405221916;0.084615555441903662 1.2974206628080649 -0.53002380228594592 0.019414964457487745 0.041087366180133804 2.2863742488993353 -0.51599191769879238 -0.12706120694717593;-0.034290849328231898 -1.347873896059617 1.5042783747653359 -0.011444672135590273 0.058047711802734894 1.6870717059827585 -1.3980998000769647 -0.030494080499430639;0.13182562836611184 2.3111719869119853 -1.2118798103849 0.029141526930241898 0.060389806944074025 0.1443149502699802 -1.9497452465629195 -0.15071154867813383;0.3854686096971558 6.9804427564791691 -3.9111369649949288 -0.020891388952477226 0.2059809992408968 0.74414424478893648 -8.1309307378388382 -0.22390362402029532;0.37811776072993575 5.9721985060496845 -3.2984403291551097 0.00022718251016934355 0.18881335649496644 0.55408409256223967 -6.7989706103415148 -0.16746826134565668;0.21113967058382335 5.7600880101695688 -5.3931135721373265 -0.25564305394747877 -0.29688388874342697 -5.2407546505427014 5.7037731041374151 0.073619574175503494;0.16317405252223857 3.4075316351797249 -3.3956979334137811 -0.14746423534860215 0.0069832004883782581 0.94465901509758154 -0.79338168110140683 -0.038014840792829727;-0.054531329098421226 -1.9009230507367849 3.1124375997273712 0.087367563204481927 0.15494633591249518 2.9455997779282814 -2.9330888496782066 -0.11741477900145877;0.043080458618456427 0.74895779302761112 -2.8610812669974663 -0.016863195722286131 -0.086538592796623931 -2.8329464582586357 4.4618349967035078 0.23376970451832768;-0.15428435093073667 -1.6609199606624618 1.9657810116062311 -0.087243199606598362 -0.15753574755494415 -5.4207074211509987 5.1758840925012644 0.26807768971761858;0.027142328804616606 2.5213533949611238 5.6946753939561177 0.038990947048772429 0.15412597309947104 5.8324400818156636 -3.5553255256040086 -0.23924665529836173;-0.011965369401413468 -0.38121865014704731 2.2988300858637336 -0.0079484775679642457 0.087432296137585797 2.6183489866867649 -4.0620769676541313 -0.19754742697375541;-0.18562149204114375 2.0183131318985534 4.0799380992931793 0.095977745004154527 0.25906584831488422 4.3469533051733249 -8.9973299659199579 -0.10647976984759032;-0.044332368359038525 -2.8303309078485164 -5.3175902165289566 -0.024233887007216952 -0.16049316857489002 -5.964723697044076 3.7347200614409148 0.23890656873853897;-0.225496535454597 -4.8105411407518037 3.8190369057233524 -0.16421749840750122 0.073196438563495253 1.5009953107811653 -2.8952232593579583 0.12237491228699587;0.049308971525918774 0.49167223302308377 -0.4932312918495666 0.041259986979960916 -0.034616629041197458 1.2603025048288667 1.1658983945940458 -0.04646906323444687;0.013478793353322988 -1.3442576555151984 0.28364476649459308 0.046711252298182071 -0.019573985838671617 -3.7212460091348527 2.1675975709121507 0.048709218871406085;-0.052670552960653635 -1.4015224104729929 1.3426619665195698 0.054097820515087436 -0.0027836588066879808 -0.22091656829712175 0.58694699459368882 0.014912563648869646;0.19699511522746607 3.2354773574510465 -6.0346530136046397 0.0098212015735415943 -0.2120740662602813 -5.7754892899620822 4.5013180158329833 0.016370304520445401;0.18299302931847186 1.4442563903882208 -8.0480016439201911 6.3302203471181331 0.42489886056752785 -0.37595582969817892 4.139684884786238 -4.164250320088378;-0.089848351883880712 -2.0148777403730231 4.9714185191403901 0.42848547309238205 -0.16992225700628977 2.6219108410309251 1.2806851090298539 0.013575983582253183;-0.38040830596088665 -7.8800588148277422 4.4617357373087216 0.050582713362401915 -0.21053726653409677 -0.9693130478540698 9.398349207966314 0.28228768970564544;-0.015708055382283356 -0.28207589166739344 2.0051009401090081 0.17110737867964029 -0.049726632830383685 -3.3341183037641864 1.9397094501035328 -0.13733739533010025;-0.082922151042942288 -1.1360836313143279 1.14395786640562 0.043833949460557381 0.0089740405566364912 -0.98928148282219996 -0.31699478403555648 0.021267523633721606;-0.3096521554071493 -1.0349596180159204 -0.41873659787841166 0.068816423357629136 -0.14687838965487848 -11.628436971434164 3.3925315751234928 0.11590019983640788;-0.090397207810137048 -2.0862000339854831 5.198600328001703 0.41087613256881889 -0.15944699325432943 2.9662509210766927 1.0519309937644832 0.015073988779995495;-0.10313074218948907 -0.5069688022929536 0.53734215119534001 -0.037973817564738291 0.032446879374502621 -2.9625926731677068 -1.4034382528319211 0.035996321793012383;-0.067793847150011438 -3.2861024591207855 -5.1326229307805891 -0.010524498496070027 -0.17505646369499894 -6.3509672734130334 4.0652718703515189 0.25208247577451293;0.12668695590250326 2.9648419526135181 -1.4616919201924981 -0.42438201948501514 0.0057269342565875762 8.571250905679328 -2.2474472706807398 0.16479616455395582;0.12318792663574563 2.7041583159215672 3.2155229627626611 -0.20209009349559812 -0.17119398609610728 9.0724342075955562 -8.9126393102248844 -0.32374953905343262;0.025876143230804893 0.73784275340731764 -1.0242499885961633 0.028912078079176083 -0.036297696216395232 2.2646955765676311 0.58732218741936015 0.037697293159280075;-0.15933585497442096 -2.0763121706754721 -0.10064313960103437 0.054993484383852147 -0.15809043076584445 -5.6422200471299195 1.163651153323191 0.36436343664752335;0.015985257857042568 2.8865498641221166 -5.8554483086398177 -0.48737176928939918 0.066980220913059746 6.3076898467694216 -1.7435150756017717 -0.16527211277413878;-0.15936905830959355 2.0951423903084447 -13.771415869678519 11.889362940881893 0.73371993390568502 2.3423498353761363 -8.9389597394834297 5.9505440368912801;-0.20501289788232388 -4.4951356511139267 4.4863901249239033 0.17512890360627034 -0.0057323541908740469 -1.1294796603219808 1.0280778899920815 0.057374324482859312];

% Layer 2
b2 = [0.11638384051449507;-1.4236507481161464];
LW2_1 = [0.087921264346989783 1.6899984952198748 -2.2502880627680431 0.21830803139308155 0.37158365718258535 2.0341387972907228 -0.88806687621192959 0.29928504921195181 -3.202364258654836 1.7273321219962561 -0.12802953194931441 -0.49185631645385663 -0.4910466413307441 -0.86401803260325805 -0.27041669275346492 1.3208714831420785 -1.1577684854471804 0.0041394183060346652 2.7608883832321904 -0.082468785498845301 -0.012525592664917878 -0.0074027849066233596 0.51959422601273364 0.058214186473073117 -0.043494786821999122 1.1627660294114264 -1.5964564252085711 0.088320908121939504 -0.35010863539364534 0.016514289215631417 -1.1266223363592951 0.0016571625062492051 -1.4190525440439599 -0.0069370771976221945 0.041659066859736235 -0.19542523530576272 -0.68315233704652556 -0.041683262838908608 0.028732850210802002 0.41893952499326181;5.0722825611992768 2.0811494445940291 -1.2919350621919952 3.7651919045018296 -0.23486306930004308 2.7515546654293761 -0.3997980733893518 -0.16094155263601648 1.6614754987906413 -0.99471073189662118 -0.12714514567868171 2.0246782112034869 -0.2407144427458629 0.37703867962644244 0.084406231484205854 -2.2156777523658668 0.32998953415175819 0.037244287828065541 -4.441931544760088 -0.11278082272736888 -0.95451661710046154 -0.25939020917924915 4.7048377133228918 0.078586346324444292 -0.0029756695032952729 -0.04186993775203289 0.73980497801343614 -0.086362052420793201 1.5754030254401246 -0.052022640734015198 0.027716389949706894 0.69677614163475077 2.2053200061282001 0.084037639371670969 -0.0053248556316514784 4.4665414682038849 -0.89720994979096047 0.049633624623632765 0.031960814632022265 -1.3900091018911955];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = [0.1;0.1];
y1_step1_xoffset = [-10;-10];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
