function [Y,Xf,Af] = net_cylinder_quad4(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 08-Jul-2020 10:29:36.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx8 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx4 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-10;-10;-10;-10;-10;-10;-10;-10];
x1_step1.gain = [0.1;0.1;0.1;0.1;0.1;0.1;0.1;0.1];
x1_step1.ymin = -1;

% Layer 1
b1 = [0.9276644587477373971;-16.298623776142495245;10.694462516467213575;-1.0626623365598510951;-0.64796873364174412124;4.2939710028702275935;-19.518111023934331172;0.35687082121686108938;-3.0820275685293383461;-0.37661458605738690197;0.19173920691525794813;-1.5494730087137122965;-0.47537778446851036707;0.51789579186603618144;0.71410836655060849765;0.077563958248205458479;-1.3733510875478172064;1.3221783448385751036;-0.70061720866645404993;-0.2781618339262191264;0.019087124553505595975;-0.4556397718455449386;0.418706045696310869;0.33687518673696953408;0.40653605832882122595;0.4625360983376929358;-0.46123338161057059192;0.61963381390414251637;0.2850922924365815736;-0.52982142171631707583;-1.6558877784385803711;-0.50385963565098867978;-0.44493654115826047901;-0.28475231636810932612;0.42754060792075393449;15.570332920596714033;1.8298005193426374326;0.45916184173718888051;-4.5792990745644175377;-10.854942708946980545];
IW1_1 = [0.62976936822208773314 -2.9996639590027078803 0.61508025415798284197 0.65700404905921083731 0.11205823644693599372 0.7107657835562571913 -0.71895697248955026115 -0.14730543954410771357;0.11081044066811300552 0.3720057420322316899 -0.030497229866874590171 -0.42558455234137371193 -0.3386170359788793216 -2.073796301550328014 14.852432643167677639 1.7066400090837394732;0.35162050153175800071 3.0725721197428055298 -12.016127079244249387 -1.3108309126026851388 -0.039886040277883887117 -1.2686315554439444586 1.4526124011673418046 -0.061222825321404446275;-0.78558722909731104611 4.553425576773353356 -1.634550918420698995 -0.92780009728449208684 -0.18482439460239261098 -1.8721106521596031502 1.9257454680593197871 0.15441516730904825128;-0.3384695609294878782 -1.1415408994731495174 2.9356640567637395378 -0.2290696920381636581 0.34795113570258390245 1.6131383338595337573 -1.660829316359555774 -0.54644970356274513712;-0.53751578429240620682 -2.4577493943410475552 2.0909408226857384427 0.88190690757366141383 0.41926258627019979963 -1.7049873747598776053 -2.2700126641003839367 -0.27522674360432125562;0.022074091561938222195 4.8078782074186090512 -20.581574765352460332 -1.3836605888629966987 -0.41992651159789384785 -5.1639845390322181018 5.3135894771279241766 0.35595523859610850304;0.0085534276461993099389 14.483209233365094804 -13.138275523450763771 -1.2033943776117566049 -2.1261682600883760053 -15.519990438731548821 16.602595821851718227 2.7597182727690010573;-1.6240967591265398351 1.529909590909135586 6.8245219153684884006 -1.0823988108477611281 2.4646081787963485255 5.3049095509158865624 -5.2360242782206629641 -2.5230612588302636645;-0.33757232862006303353 -7.9733683845326988049 -3.3870137543346259257 2.2243801038788779678 -7.0852396816717151395 -9.5695802493647406095 0.51947177668485167157 3.3503446908667977588;0.0011036671642558639177 -0.064441447886866343175 0.056546853573668162674 0.0032797137702896901786 0.0090500642861068812672 0.17785928844678952632 0.056622678912408297425 0.004915541420786819285;-0.74565690618796021116 9.539324043541750342 -0.1848341123339736769 -0.76356865158091902224 3.4777975664019171731 -1.3487940646591738414 -5.5167872175815322322 -3.9683427167573404049;0.29190983955526184079 -17.672146162295668148 15.438478974600592153 1.3495106536557233134 2.8986718350886877538 17.876592436457897861 -19.09180039923943184 -3.3283022934791630654;-0.095988017702682365551 -0.13429291927815220631 -0.17787880435990957584 -0.10338130222942674974 -0.032451258653831145662 -0.26990929660173779148 0.28984909391774077436 0.0089529525413560972352;-3.7669808546894612 5.1072204783281440754 -2.1942942423169875532 0.019052310519364561159 -0.39190322470259936205 0.023747408867660437654 0.54394992513662820954 -0.15392987738024585531;-1.4004423236167344857 -2.6448489925835438896 8.584667358565694073 -0.13006076163667279477 2.1944683107712288361 3.4423580107684066398 -8.1225606597498369865 -2.3972305529151896053;-1.6268815870556101455 -2.0343902600021666061 13.753533300569825926 0.13063559531565524519 7.1980318793270754441 11.444154639918401983 -3.4163615820086064012 -7.7953205355803225629;0.05957233774165778678 4.1770116357324882372 -3.9113788633085047053 -0.27813822423699779973 -0.018185398063937888158 -0.46330328505889484259 -1.098682445196450308 0.19722704508046046135;-0.033598958512854000535 1.5761984851720900469 -4.8466276112405068943 4.1424369455997442913 -0.048673995004401053588 0.56064594010812640601 0.014860906640883700391 -0.51712936684418264743;0.93020714956409922269 24.452101751687386866 -25.395870245940635357 0.012495542305614983081 3.986026795241929932 24.894791955732433308 -23.130256267458797481 -4.7007495813397213169;-0.87913520236131859065 -19.320207656919578199 19.465222512397811983 0.48539778556693302658 -0.77121446261557802249 -7.4366834480613235314 7.1294128717106444171 -1.4341334988145297835;0.78604270715924773327 6.6122036818198131058 -8.259932239227481432 0.52125298950929332964 3.1599740705263990037 9.3676547808943091411 -9.4021477699525899396 -1.1030538305029169432;-0.2967698307997550522 2.6852972122522134057 -0.74166600963637485666 -0.27741359159486367325 -1.168723245225451679 -4.6260335784612367505 4.5959460621249039747 0.94877791455097582052;-0.87016750321906721766 -6.3354783209936380572 8.1764520889183760488 -0.57027601756704793257 -3.3743617355607207209 -10.519416883798568207 10.545521605593005887 1.3032538118000063232;-0.27654396603595876591 -8.0817220067798452021 9.8566503745505507084 0.57590468869878652658 -3.1497994451363462431 -6.394833233243145898 6.6526354316272664491 2.7551199503981984584;-0.20162532559970572366 17.048438843172686319 -15.124658981829387727 -1.2722357615580937029 -2.7624289508301345109 -17.404131584931324284 18.57415006934782653 3.2201041386097850605;0.20433810536653151946 -1.8875913473875978177 0.11528603268525611236 0.16101201021343705677 1.0791567961496990602 3.7546494842048527829 -3.699261413098931417 -0.9068264562782685223;-0.73350953921657546797 -7.0937834893952746995 8.6450555193708513713 -0.50998545345180401611 -3.0821852189691432145 -8.6809912454717395036 8.708256239618785699 0.95196675614398884591;-1.2692018735973009669 -2.2778486443609065049 7.8098369135940517438 -0.099514139194905038011 2.0410381011945424312 3.5985984018058463363 -7.988154218239255755 -2.2425951290494561263;1.3321822318830842669 2.0432312934780498814 -7.7863857666660942769 0.10474046780309594074 -2.1330109576514422187 -3.8214217327882691322 8.3703687821076329101 2.3261624937976330685;0.081692595621871866296 -9.0112167321047724755 6.630363296581489152 0.43672964612908732329 0.48804404458877803652 -2.0686042613601278717 1.2848153061672504816 -1.258624244184517238;0.87547561724291067531 7.0833032242289677427 -8.4637515202670687842 0.80186945676219734125 2.6320010907933197863 7.624533514668097034 -7.7095553949320247966 -1.4600628127748280782;0.25482331648597422724 -7.3543394327464834959 6.324417494304227283 0.79532070924502862308 1.0375143209297430502 8.3143556037382371215 -7.6352250325464225966 -0.89909395463510544122;-0.309751306506086177 -7.6751682934105103229 -3.6336409086377297051 2.4038388746503627225 -7.0680947647072924767 -8.2501940270471845196 -0.570717447273436429 3.4330174282678473929;-0.1030141375271259041 16.070918972596572871 -14.439378765198961574 -1.2213843677083953132 -2.5410805493338393113 -16.699736509079283309 17.815989402453343615 3.0360927158266597381;0.65800420695580275066 -1.5734947837042045915 15.119362565836823364 1.2317153119648402981 1.6018525299466259693 12.044837771843178942 -12.067959226812037699 -1.503398385347099131;1.0145949283086759252 -8.4484162696983098328 -1.946854819602858333 0.82985479138971740554 -3.4430428682497735693 2.8287292382022033443 4.3804175070815087878 4.357898735066574325;-0.071875794317308824843 9.1279813931346627243 -8.2173400222887629241 -0.79333301416490720204 -0.92991663836076032812 -5.2368623848862405623 3.9690496030446942299 0.84047299034771516535;0.46511093346529563952 2.3400506928373707716 -1.9987046809012154469 -0.79065576890382982533 -0.38522493412875941088 1.0448804383295000608 2.5458960364017904077 0.29992881821474909332;-0.28816241094885414187 -3.1735182543976212521 11.67693447566853493 1.267407061192244111 0.058022789431642997349 1.1405925591939665154 -1.3017213763120991654 0.033775760361556592115];

% Layer 2
b2 = [2.4364189779544656034;1.5910775702213681981;-0.99809447346869906159;0.094293342161618262653];
LW2_1 = [3.706821398849039717 0.0036751185625243168453 1.5288947134191270827 1.9457752109656156758 -0.32585513774284025068 0.11116296738236869368 -2.3358765861030104105 -0.62245299947713295108 0.023903361577017945283 -0.17661190399215251357 0.1681811716026960779 -0.10622554566564046397 -2.8638022161014231592 -7.4049914820985502928 0.4251392479266690172 -1.0162591280838737529 -0.010743591649068219562 -0.10317153753262327254 -0.34771205469735011473 0.053280039510428568728 0.10518662883733125024 5.7985868932129758235 1.5093908114943599408 2.8950247480157154101 0.059215520000238684728 -6.296809066412 1.7602524764175917493 2.7064444922185426634 1.9953249400354768905 0.94713347034703643246 0.066228254010456913403 -0.12048182559585079998 0.033321854937304322408 0.17431898194460229701 4.0709379177160611718 -0.017850177581038344232 -0.090414884686806931691 0.081050181512196534106 0.18981935599066407372 4.2626141932810046598;3.3879283123725545401 0.059085201624441065216 -1.3236401076961294976 1.7517455087080855414 -0.32598912143515795803 -0.041611290947988315014 2.3260660629037324121 -0.32054424395948299953 0.027910476956627718048 -0.18083927404410621298 -0.0036438014269881279124 -0.10091366810291726996 -2.2976151705234006961 -7.0929622802899610079 0.40173971289206850122 -0.83184080206609545272 -0.010806279259318285826 0.041625965541199759501 -0.32844966895582528021 0.039764202771933827851 0.061477952176037957421 3.8969366898440758185 1.2797781560153465019 1.9985538068511849996 0.03195544413995772548 -4.7779905130282003256 1.4575162696362451431 1.7704650672376935905 1.610505255071589259 0.75094317405440069724 0.055628106758457751546 -0.11484666104034046974 -0.097485446469868522468 0.1772418230702469677 2.7780604738668719378 0.012923853719827573319 -0.086263208806820285135 -0.11072159153898988859 -0.0916041261505053106 -3.8783942672451243716;0.1706403748764072914 3.1478829793739255827 -0.034226100001543344198 0.072877008859062397672 0.0033415435238421100847 -1.0447706536738676775 -1.6655949974775734468 0.64592892381357491782 0.00059838718460364414067 0.048028038543882933809 3.9319089099593256265 -0.040099124321981448327 0.85976325842548351197 -0.28333902685631617846 0.023693355627137740321 -0.29073188588246134945 0.00051229523488204606416 -0.086106951151409788503 -0.014883241727214112024 -0.022936717214956669347 -0.01295412079730599679 0.30829119253178116633 0.029556732133933942552 0.12568134642190886829 -0.0052809524009619175297 2.5374179262578655525 0.042386807105266766094 0.16218166428093680476 0.56793071663243355207 0.26934739480917202492 0.0065257196716579351364 0.01935215665375741162 -0.11476584018111594954 -0.047596925362171478568 -2.3620158627931235884 -0.072541566779926625053 -0.035701890792549685616 -0.016236211442413807371 -2.9167896516314124611 -0.083520103350873411974;0.22532184611453265344 -2.9257564914056546357 -0.0096383023401939039304 0.22744055290724776719 -0.0032270453898283354109 1.0397932118208228491 1.8341003263087360953 0.10707158531188035178 -0.0032162321541146458165 0.037547517444199707271 3.8244900028591377605 -0.027569095554567827483 0.074764902147228015639 0.017013097068158435088 -0.0058715150428105405966 -0.20402962178584616026 0.002362434583489221411 -0.20279149226058046374 0.011336475042831133109 -0.047146744466752134317 -0.013136563695941055191 2.1988990553682188356 0.26153400405898935555 1.0961490676983809411 -0.0086616460325187553254 0.31093526705616736372 0.22896377400411507819 1.019885696594454938 0.38107700188236753869 0.17388728161897412661 -0.002675935049263702438 -0.028708817912116428583 0.052444932162219029537 -0.037357927973327327564 -0.36361566923866883716 0.075636269491149196731 -0.025984991599755247887 0.072687371742477344116 2.8443163772822601665 -0.044503716295077690168];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [0.1;0.1023025944832;0.1;0.104020594010611];
y1_step1.xoffset = [-10;-10;-10;-10];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
    X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
    Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
x = bsxfun(@minus,y,settings.ymin);
x = bsxfun(@rdivide,x,settings.gain);
x = bsxfun(@plus,x,settings.xoffset);
end
