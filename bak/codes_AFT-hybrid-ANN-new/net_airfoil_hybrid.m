function [Y,Xf,Af] = net_airfoil_hybrid(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 24-Jul-2020 08:33:05.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx8 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx5 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-10;-10;-10;-10;-10;-10;-10;-10];
x1_step1.gain = [0.1;0.1;0.1;0.1;0.1;0.1;0.1;0.1];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.0734699745904694446;-0.026749671141808650798;0.73029892339317348249;15.127541887870382453;-1.39806456082182895;0.40883359454775369812;1.2205683627646766176;3.0642011304834593233;-1.2296097255197655507;-2.8924862606023724609;0.93645466369526531025;0.809850913637349068;1.0546149564857134617;0.71914709458048031721;0.69254635667798813969;0.046049909078863693335;-0.020471118761340782038;0.2318252261815541837;0.15137343784220430587;0.74994392226972561577;0.06171648894636221766;3.4325898016899900611;0.596196916040943381;-0.4332337491897803039;0.049027295986089729218;2.8113678357903180149;-1.3991885856630221774;0.014087321454662996359;-0.11995323522889332624;-2.6235189364637006015;3.2676130228544519873;0.67745117603912829995;-0.035043934461862144558;-2.5246978930099390759;0.00083583157338327389915;-3.1405507936283858506;-0.80307021481056095613;21.460994928549780525;-1.9945229770125858515;28.441776082188123809];
IW1_1 = [-0.39823768508504381325 -9.6259659213179986637 7.4803532703206254695 1.1484247786435040073 -0.32972780471461426988 7.3038616241319695987 -0.14122083907469396014 0.63936106364194444929;-0.09894918063645603834 0.41260741253284904939 -0.30743501073441176219 -0.015133340667943178531 -0.023988401986665908172 0.48384923174439153915 -0.41378910059221940543 -0.039187394107253303854;-0.059252978107397769048 -0.38698724951742602407 -0.29886744370080264854 0.0010110073297790759736 -0.16236817297544653416 -1.6898441681377152079 1.6651666948787036127 0.157685037559090524;-0.55251149352220674249 -1.306308042741755937 0.94503272070915811387 -0.13645798352939103593 -2.2091395790624694939 -5.6274926791647681412 -6.3755057854804357831 -0.37924271474891046996;-0.13895628043011817865 3.2967801142888166765 -1.4099901605073994482 -0.28303119204488691452 0.20021869847681561527 -0.16795014552286668952 -2.0261460100435879639 -0.045505970442145091126;-0.059364405836114547688 -8.2951742154636658455 7.9302298519508944707 0.50655244404165922223 0.66632131111886661046 5.9575558493175027053 -6.4643309975019080937 -0.17987521337671005806;0.10954206706184285713 -2.623613713248145185 0.9426415531983320939 0.24919207281713678936 -0.27111071486065763114 0.56403940948649222697 1.4615321726641319344 0.025601120932071532582;0.35619235542302335462 4.6694322494289135506 -6.5429272114512366798 -0.36091387152894194301 -0.075383591362847821027 -2.4216221308215839514 1.3035502337933790873 0.042111600968168114156;-0.15463084008169011851 -3.1506930766354512841 3.7112816882050316813 0.18846819167203998635 -0.053459350835848178096 0.36084459019980552608 0.89815227871500680212 0.11905569043721660194;-0.41105351589018368497 -5.2047479310000257513 8.5771511729762188736 -0.45777181278811968079 0.34480207868515294622 -5.1872893859022353169 1.5959254075232864878 -0.074931933143035200917;0.27031760084503231312 3.385326705261771707 -4.794603925703431635 -0.21706824834651361478 -0.071246869984687363764 -1.6140608171541097615 0.80786346121999375036 0.015535195616740667124;-0.12459449241231122796 -0.14154421681934245547 -0.25085178258992252287 -0.051508806996211416174 -0.14998218097646728864 -1.1084583135585133196 0.70269689791727762973 0.11262512043534046724;-0.45643781354177498377 -3.7313706436828426583 3.8314010659175479212 0.67084020832881796625 -5.3463511587103411671 -3.7844728771605886664 25.440412453340083943 6.0084723746164314662;0.44764881369514625264 -3.9440379538305094798 -4.4426554726225475633 -0.13514955781688833825 -0.028306426175417263164 -3.9784416872003700583 0.90720447250461799804 0.28878317585731339001;-1.1611715397999158306 -14.762658797664848009 15.290998282713431422 1.153608870314394963 2.1130649437875641539 22.847574740220547795 -11.086805660527614847 -0.70888137273719020737;-0.34391051554185619876 -1.5881382536224906143 2.2506614161114306683 -0.22216183668397032624 -0.67048694319227131189 -11.727824949773525631 11.966054391861861816 0.44599615282839155661;-0.34059461057510187487 23.408462324334976756 -21.715031275906873987 -1.3605960208144467494 26.921920686355132801 -22.623282706221850447 -3.9906896950629908716 -0.24378150748979521278;0.29166448959822310893 5.685022266132528479 -5.8127823817456434341 -0.63494303107554428411 -0.17793472394601489439 -6.9315191761465237974 -0.13386203715217914745 -0.62664501621667489939;0.086624148773852771566 0.17238727864185027228 -0.423384875074880207 -0.018955700201919476605 0.01597491175313230094 -0.43900035823744720798 0.42393798748486261063 0.028847484002321049229;-0.021273229384209654813 -0.95463995642834609257 0.25533577019127717822 0.14592507500576315516 -0.42832142115138438498 2.3063123271727552499 -0.61416821585460690258 -0.0060324767246579362456;0.31889964666066134003 -7.396697153965219762 6.7102526495577556886 0.41375463839083681528 0.70324597155440504714 4.7193550685416258972 -5.3263757054662379531 -0.089877159822396121558;-2.9734414060855907103 -18.501629163562100189 -13.065589666437395167 -0.42942254810999636039 -3.3147660308380544336 -4.5129266274424475469 8.2056437069007746032 3.2893047128460528583;0.33358012257241859144 1.6271391022041727936 2.0765662076554276538 0.81170568580618285282 -0.82980216968768349961 -5.8913587029943101925 9.8570913614863417962 0.22338729952546654278;0.17738753397131759582 2.6572598008397925184 -3.6554932847468726287 -0.19070424532048854682 -0.064263860535608244295 -1.1388864665154974087 0.36782738078617610578 -0.011971310297659276331;-0.65804910479754608055 -10.900233437175172568 11.281436563375292437 0.3483841639398122525 -1.7552122862324450736 -3.1027769691680844311 4.5432607472616730604 0.34599708883192081821;1.0513574502833276103 6.7670743976459020175 13.601414110823727199 3.9840874618228863113 -0.25356670634083594562 11.248162347093041191 8.0699977761568604251 0.24384609099416160172;-1.0435692786109236341 -9.2303720969990834533 5.5955391471015181182 0.38530482748939542947 -0.030189770066371898749 3.9615570771773862546 6.272709072076411374 0.31430802060202239767;4.5460729751045789726 -23.860542535238685957 18.717996715702227561 0.63888605199402836998 -28.854865186856507364 32.886731964169172215 -3.9022925413418567686 -0.25676697087863759039;-0.28723585953157060313 2.9094478286134468625 1.621688143873913468 -0.0080607139964035765672 0.34361959038990580462 0.36863943094102608056 0.059401819978666177413 -0.29686088945871619282;0.77995804008809066499 3.8188076716973000657 -7.0671170931880507027 -0.24506416277988402053 -0.35710499567188441761 -2.0219409323143491264 1.8317486531068978284 0.19571890230236413388;1.5326530651352379131 8.1954640684247621607 -2.9370933779376668937 -0.099366546842501610182 0.6081524660618029543 17.190814406046161622 -18.035035659034551969 -2.0311892033360496868;0.070224816859233804567 0.13074273464222210817 0.38104024340604725207 0.020175257404540066636 0.154680381886701801 1.3064546310522555661 -1.1645434504383063157 -0.11588613196570025921;-0.1360791771209695078 0.50843634339812493472 -0.42578128581872620728 -0.016950338126545803907 -0.020556169428931958532 0.80831877868366308615 -0.71238650371643430503 -0.060539812196315705151;-0.55031927995376916929 0.39080665703366246344 -4.7221304417730145531 0.012399377447448213518 -1.6170818094973904433 -6.86481980233747624 -0.084021488725957618748 1.0148063381157230722;4.6214616532567873719 -7.2008028572405109458 2.364829118955969367 0.22262676722153079689 2.7547872158681738775 -2.702916001939473567 0.048535945789620178747 -0.09217743585758274294;-0.99612186481768916213 -4.7971757113102881931 3.7820543222113309767 0.24921395571620344467 0.12018764196902405328 3.8643614015360627789 -5.4919706072821483644 0.1736558093817602566;-0.35204448535335514103 -6.6884580831006559265 6.6366679833280262102 0.29874427278578780109 -0.39265571657494263702 -8.3623465209253460273 8.1245809872340846169 0.57818955276544581334;0.068106736367508718955 3.2435177894031266277 -3.0907059677517723095 -0.51111930295765817256 -0.50902758004020742799 -9.800807665239329225 -8.8759057819478961449 -0.36503741991019561519;0.22612926101935815204 3.1486033786514777688 -4.5043894372911017498 -0.19286161563603582136 -0.14143575136632544065 -1.0055380033888141611 0.36207100144158232968 0.0063495955410452767018;0.38380048713998843324 4.0750789970514498251 -4.1286908803549797753 -0.53517993505962146994 -0.48557600195382460972 -17.112058384431893643 -8.5324339613603594756 -0.29122315004364152102];

% Layer 2
b2 = [0.84657072861383386719;-0.41446461931009415114;-2.7093065736527126575;-1.7076302394060935974;-1.7365022791144781866];
LW2_1 = [-0.0023813917811894066284 -6.6285366572882677971 -1.2201635424441159561 -0.00297712672622602861 0.20096353836283362138 -0.024097722599476276151 0.25541291869818993909 0.12407782238749036352 -0.19142001546571496551 -0.011454037420784034598 0.16050117785415105032 -0.69346386464925013904 0.003499591945123962846 0.0036709679092104927252 -0.0077943817649759675192 -0.076176071711270221254 -0.0015113480704410542799 -0.00081633342137391853768 1.8268817084106172555 -0.096320389133393288783 0.15513555356244473904 0.0011066535874618018374 0.0057454125088070313182 0.38619496456793939165 -0.027383400220017489052 -5.0570080934358599227e-05 0.00086079607980824295738 -0.00088076006410283780128 0.0088654664092000408371 -0.045917501035126775943 0.0078014027207890185647 2.379382262121395808 -0.45755392110854398169 -0.0033598870629546460399 -0.2774132551271302205 -0.02856568352581766515 -0.0064073576482284438222 3.2199966172919332053 0.42804240001086402145 -4.6184363014906155698;0.0033243531760072065825 -6.3201199899394433501 -1.0108099581185934213 -0.064891506884957830814 0.022512332435648686746 -0.033315090040674601168 0.043896364270882677616 0.14370827114199505314 -0.12660068958395989669 -0.0042728498680098822918 0.15163451615924236626 -0.61099950000154112928 0.0051775053268305103529 0.0031533207955090057119 -0.0047301831671600390664 -0.062708882721379546887 0.0070410909858749067339 0.0025163771036112417452 0.63261955463140662204 -0.039367511471646979282 0.1620567861253310038 -0.0011568250011630815642 0.010841486226028703571 0.33343824543401895388 -0.038534396761310180102 -0.0018609214616029283798 -0.00053817373036527994552 0.0033822102081470725721 0.0024620670876976335183 -0.039956905379420933067 0.0081469484938014764819 1.9769922412194482764 -0.43378829091733733803 -0.0049091258683394691995 -0.24651304671620385967 -0.032097559508337980549 -0.005144150242122933793 4.8627693649458780811 0.35350917297550971119 -4.7534070164455384244;0.0050098818412480476681 -1.0493761523102047573 -0.43208097644896986678 -0.050702978913749474632 -0.12580913055559073133 -0.038552388947032487088 -0.16244614503461354826 -0.28413784289647958659 0.072392019804122020865 0.0088074294069282622194 -0.32021875766052732004 -0.41563036277845749611 0.0020664949828791130508 -0.0013830156894145825223 -0.0021578536935269463162 0.033362403148876687564 0.046015133965395769999 0.00090587215538109422484 6.9709432081314659513 0.093886992604550634223 0.19327674388794893745 -0.0014155170421160311826 0.0086985496394486154503 -0.42742171714994503517 0.096973797403265060701 -0.0018794083671052591155 -0.0019179422134971472157 0.029909837484618437276 -0.0029844091192021676012 0.084931306603606926409 -0.00080753041345410904537 1.002384954028114894 1.8916697983051773413 -0.00021764362066664953493 -0.11450017003853921183 -0.022831644637699974321 0.011862039781969433219 0.58473737557961513733 -0.52587583922406178072 1.0633743586786981172;0.0038053580774373698889 14.906260238275161001 0.22935922671920111471 -0.053184206036433791243 -0.32781564703034998809 -0.030848457809455727407 -0.41695635368126598985 -0.40135262706634866614 0.18706534954407580407 0.019626329816120505894 -0.4409227544711254998 -0.018254662778138860263 0.0031536101043884894393 -0.0030157718069156670866 -0.00070704972257472028553 0.0079194199330631098732 0.015226829036329502659 0.0036465373877629984022 6.0429437312868605758 0.16870356248055856652 0.16552581935084006992 -0.00094360632873160263986 0.0014001828216860152682 -0.69302046352890656067 0.082730083557843253628 -0.00081550349571304350457 -0.00065691983041402937302 0.0089611132483442788865 -0.0022909924501091014082 0.096631597066037328014 -0.002646092509033113032 -0.31692756783431230705 -6.4112125858930575362 0.0033657397189064694812 0.058148541392860714216 -0.0087396226430864667328 0.0093464684853889687388 2.0815178036356916103 -0.77944942505989189829 -1.0795956018216257277;-0.18667829198301313931 4.0425896537282630661 0.46589420678696052969 0.097116377097546030539 -3.7402515238454148161 -2.5300748605456715445 -4.9615768036637595273 0.24920818437550931734 -0.047406380166214706628 -0.15946787668683048977 0.2342369945477023041 -0.82664322930569422709 -0.18776883994499130037 -0.29688191471331681903 -0.28446836521017115906 -0.084167862842370613774 -0.015761577627571986271 -0.48245293720862919562 -0.062803035071189824978 0.89330690032642434684 2.6344239022782938164 -0.14175906951673139522 0.046219474925322578951 0.4977129598275876754 -0.14368818679100298086 -0.086828225378950407709 0.23981467587103910688 0.0059795278529784943664 -0.44086058885832846155 -0.11985888780346000415 0.0054313182502798785026 2.0684337884059731394 3.4573593059464049482 0.034654592376223321282 0.026267569779067370672 -0.02823042291291037037 1.4783651136343318733 2.6475717665804254786 0.7870124750114876333 0.42129982167815138716];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [0.1;0.1;0.1;0.1;1.81477345849321];
y1_step1.xoffset = [-10;-10;-10;-10;0.000243036485509083];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
    X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
    Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
x = bsxfun(@minus,y,settings.ymin);
x = bsxfun(@rdivide,x,settings.gain);
x = bsxfun(@plus,x,settings.xoffset);
end
